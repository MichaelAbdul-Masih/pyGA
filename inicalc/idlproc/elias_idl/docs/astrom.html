<!-- This file was generated by icmk_html_help.pro -->
<html>
 
<head>
<TITLE>Extended IDL Help</TITLE>
</head>
 
<body>
<H1>Extended IDL Help</H1>
<P>
This page was created by the IDL library routine 
<CODE>icmk_html_help</CODE>.  For more information on 
this routine, refer to the IDL Online Help Navigator 
or type: <P>
<PRE>     ? mk_html_help</PRE><P>
at the IDL command line prompt.<P>
<STRONG>Last modified: </STRONG>Mon Mar 31 16:37:17 2003.<P>
 
<HR>
 
<A NAME="ROUTINELIST">
<H1>List of Routines</H1></A>
<UL>
<LI><A HREF="#AD2XY">AD2XY</A>
Compute X and Y from  RA and DEC and a FITS  astrometry structure
<LI><A HREF="#CAM_PIXELS_TO_PIXELS">CAM_PIXELS_TO_PIXELS</A>
takes cam "source" positions defined as x,y,iscd
<LI><A HREF="#CAM_SRC_ASTROM">CAM_SRC_ASTROM</A>
Takes the i, j and scd positions of a detected source
<LI><A HREF="#CAM_SRC_LOCATE">CAM_SRC_LOCATE</A>
Takes the RA and DEC coordinates of a "source"
<LI><A HREF="#COMPUTE_DISTORTION">COMPUTE_DISTORTION</A>
it computes xd and yd, coordinates with distortion
<LI><A HREF="#ELAIS_NAME">ELAIS_NAME</A>
generates official ELAIS source names from a
<LI><A HREF="#GCIRC">GCIRC</A>
Computes rigorous great circle arc distances.  All computations
<LI><A HREF="#GSSSPUTAST">GSSSPUTAST</A>
Put astrometry parameters into a given FITS header.
<LI><A HREF="#GSS_PUTAST">GSS_PUTAST</A>
Put astrometry parameters into a given FITS header.
<LI><A HREF="#ICAD2XY">ICAD2XY</A>
Compute and X and Y position given a FITS header and A and D
<LI><A HREF="#ICBACKGROUND">ICBACKGROUND</A>
gives the background from the IC models at and given positions
<LI><A HREF="#ICCAM_MKHDR">ICCAM_MKHDR</A>
Makes a proper FITS header for a single CAM frame
<LI><A HREF="#ICHASTROM">ICHASTROM</A>
Linear transformation of an image to align it with a reference image
<LI><A HREF="#ICMKHDR">ICMKHDR</A>Makes a  FITS header with simple astrometry
<LI><A HREF="#ICSCAN">ICSCAN</A>
Construct a scan from a supplied image and the ISO pointing history.
<LI><A HREF="#ICSCANRD">ICSCANRD</A>
Construct a scan from an image and a list of RA's and Dec's.
<LI><A HREF="#ICSTARAST">ICSTARAST</A>
Finds a least squares astrometric solution for an
<LI><A HREF="#ICSTRINGAD">ICSTRINGAD</A>
Converts a string of sexigesimal coordinates into decimal degrees.
<LI><A HREF="#ICXY2AD">ICXY2AD</A>
Compute a Lat  and LONG position given a FITS header and (X,Y)
<LI><A HREF="#IIPH_POINTING_ASTROMETRY">IIPH_POINTING_ASTROMETRY</A>
CALCULATES THE RA AND DEC OF A POINTING
<LI><A HREF="#IRPH2AST">IRPH2AST</A>
Construct astrometry parameters from an IRPH file.
<LI><A HREF="#ISOHDF_NAME">ISOHDF_NAME</A>
generates official ISOHDF source names from a
<LI><A HREF="#MAKE_STAMPS">MAKE_STAMPS</A>
Make postage stamp images from a FITS image and some positions.
<LI><A HREF="#MULTADSTRING">MULTADSTRING</A>runs adstring for vector input
<LI><A HREF="#MULTSTRINGAD">MULTSTRINGAD</A>runs stringad for vector input
<LI><A HREF="#PHTITK2UTK">PHTITK2UTK</A>Converts PHOT ITK to UTK
<LI><A HREF="#PIX2IYIZ">PIX2IYIZ</A>
Converts PHOT Pixel indicies into two element indicies
<LI><A HREF="#POSTAGE">POSTAGE</A>
Extracts a postage stamp image approximately centred on a cellestial
<LI><A HREF="#PUTAST">PUTAST</A>
Put astrometry parameters into a given FITS header.
<LI><A HREF="#READ_DISTORTION_FILE">READ_DISTORTION_FILE</A>
it extracts from t the ascii distortion file the detector ID,
<LI><A HREF="#SBGS_PFOV">SBGS_PFOV</A>
This program takes pixel position arrays as input
<LI><A HREF="#WFPC2_2_MERLIN">WFPC2_2_MERLIN</A>
changes raw HDF WPFC2 positions to the Merlin reference Frame
<LI><A HREF="#XY2AD">XY2AD</A>
Compute R.A. and Dec from X and Y and a FITS astrometry structure
</UL><P>
 
<HR>
 
<H1>Routine Descriptions</H1>
<A NAME="AD2XY">
<H2>AD2XY</H2></A>
<A HREF="#CAM_PIXELS_TO_PIXELS">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 NAME:
	AD2XY
 PURPOSE:
	Compute X and Y from  RA and DEC and a FITS  astrometry structure
 EXPLANATION:
	A tangent (gnomonic) projection is
	computed directly; other projections are computed using WCSXY2SPH.  
	AD2XY is meant to be used internal to other procedures.   For 
	interactive purposes, use ADXY.

 CALLING SEQUENCE:
	AD2XY, a ,d, astr, x, y   

 INPUTS:
	A -     R.A. in DEGREES, scalar or vector
	D -     Dec. in DEGREES, scalar or vector
	ASTR - astrometry structure, output from EXTAST procedure containing:
   	 .CD   -  2 x 2 array containing the astrometry parameters CD1_1 CD1_2
		in DEGREES/PIXEL                                   CD2_1 CD2_2
	 .CDELT - 2 element vector giving increment at reference point in
		DEGREES/PIXEL
	 .CRPIX - 2 element vector giving X and Y coordinates of reference pixel
		(def = NAXIS/2)
	 .CRVAL - 2 element vector giving R.A. and DEC of reference pixel 
		in DEGREES
	 .CTYPE - 2 element vector giving projection types 

 OUTPUTS:
	X     - row position in pixels, scalar or vector
	Y     - column position in pixels, scalar or vector

 REVISION HISTORY:
	Converted to IDL by B. Boothman, SASC Tech, 4/21/86
	Use astrometry structure,  W. Landsman      Jan. 1994	
       Do computation correctly in degrees  W. Landsman       Dec. 1994
	Only pass 2 CRVAL values to WCSSPH2XY   W. Landsman      June 1995
	Don't subscript CTYPE      W. Landsman       August 1995	
	Converted to IDL V5.0   W. Landsman   September 1997
       disto(rtion) keyword addded Seb Oliver August 1998
</PRE><P>
<STRONG>(See /contrib-linux/rsi/idl_5.4/icstm_idl/astrom/ad2xy.pro)</STRONG><P>
<HR>
 
<A NAME="CAM_PIXELS_TO_PIXELS">
<H2>CAM_PIXELS_TO_PIXELS</H2></A>
<A HREF="#AD2XY">[Previous Routine]</A>
<A HREF="#CAM_SRC_ASTROM">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 NAME:
	 cam_pixels_to_pixels

 PURPOSE:
       takes cam "source" positions defined as x,y,iscd 
       and returns all pixels that are see these sources


 CATEGORY:
	

 CALLING SEQUENCE:
	cam_pixels_to_pixels, x, y, iscd, raster, x2, y2, iscd2[, ra, dec, ra2, dec2]


 INPUTS:
	x: vector of x positions in a detector pointing
       y: vector of y positions in a detector pointing
    iscd: vector of scd numbers for each "source"
  raster: raster structure

 OPTIONAL INPUTS:
	
	
 KEYWORD PARAMETERS:
	

 OUTPUTS:

   x2:  vector of all pixels corresponding to these sources
   y2:  vector of  all pixels corresponding to these sources
  iscd2: vector of scd numbers corresponding to these sources


 OPTIONAL OUTPUTS:
	ra: ra of sources
      dec: dec of sources
       ra2: ras of corresponding pixels
     dec2:  decs of corresponding pixels
 COMMON BLOCKS:
	

 SIDE EFFECTS:
	

 RESTRICTIONS:
	
 slow and inefficient especially for many sources
 needs the following lines added to your ~/bin/user_init file

 .r /arch/scm/soft/local/lib/astrom/ad2xy
 .r /arch/scm/soft/local/lib/astrom/xy2ad
 .r /arch/scm/soft/local/lib/astrom/compute_distortion


 PROCEDURE:
	

 EXAMPLE:

 CIA> y = [0., 13.5, 10, 0.5]
 CIA> iscd = [10, 0, 2, 3]
 CIA> 
 CIA> restore,'rasdark796001760_99062414231600.cub'
 CIA> 
 CIA>  cam_pixels_to_pixels, x, y, iscd, raster, x2, y2, iscd2
 CIA> 
 CIA> plot,x2,y2,xrange=[-1, 32], yrange=[-1, 32],psym=1
 CIA> oplot,x,y,psym=4,color=3


 MODIFICATION HISTORY:
 	Written by:	Seb Oliver, 15th July 1999
	
</PRE><P>
<STRONG>(See /contrib-linux/rsi/idl_5.4/icstm_idl/astrom/cam_pixels_to_pixels.pro)</STRONG><P>
<HR>
 
<A NAME="CAM_SRC_ASTROM">
<H2>CAM_SRC_ASTROM</H2></A>
<A HREF="#CAM_PIXELS_TO_PIXELS">[Previous Routine]</A>
<A HREF="#CAM_SRC_LOCATE">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 NAME:
	cam_src_astrom

 PURPOSE:
	Takes the i, j and scd positions of a detected source
       and calculates the RA and DEC

 CATEGORY:
	

 CALLING SEQUENCE:
	cam_src_astom, raster, source

 INPUTS:
	source.x:    cam_src structure (x)
	source.y:    cam_src structure (y)
       raster:       raster structure in which sources detected

 OPTIONAL INPUTS:
	
	
 KEYWORD PARAMETERS:
	

 OUTPUTS:

	source.ra:  array decimal degrees
       source.dec: decimal degrees

 OPTIONAL OUTPUTS:
	

 COMMON BLOCKS:
	

 SIDE EFFECTS:
	

 RESTRICTIONS:
	

 PROCEDURE:
	

 EXAMPLE:
	

 MODIFICATION HISTORY:
 	Written by:	Seb Oliver, 16th May 1996
	27 May 1997: Raster.history updated S Serjeant
  v1.1 06 aug 1998: disto keyword added to allow for field distortions Seb Oliver
	25 Aug 1998: history string changed instead of raster.history
		SSerjeant (v1.2)

</PRE><P>
<STRONG>(See /contrib-linux/rsi/idl_5.4/icstm_idl/astrom/cam_src_astrom.pro)</STRONG><P>
<HR>
 
<A NAME="CAM_SRC_LOCATE">
<H2>CAM_SRC_LOCATE</H2></A>
<A HREF="#CAM_SRC_ASTROM">[Previous Routine]</A>
<A HREF="#COMPUTE_DISTORTION">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 NAME:
	cam_src_locate

 PURPOSE:
       Takes the RA and DEC coordinates of a "source"
       and returns the i, j and scd positions for any
       frames in which that source might appear.


 CATEGORY:
	

 CALLING SEQUENCE:
	cam_src_locate,  ra, dec, raster, i, j, scd

 INPUTS:
	ra:    RA(2000) degrees
       dec:   DEC(2000) degrees
       raster:       raster structure in which sources detected

 OPTIONAL INPUTS:
	
	
 KEYWORD PARAMETERS:
	

 OUTPUTS:

   i:  vector of REAL i coordinates
   j:  vector of REAL j coordinates
  scd: vector of scd numbers


 OPTIONAL OUTPUTS:
	

 COMMON BLOCKS:
	

 SIDE EFFECTS:
	

 RESTRICTIONS:
	
 slow and inefficient especially for many sources

 PROCEDURE:
	

 EXAMPLE:
	
 ICSTM CIA> ra=249.381
 ICSTM CIA> dec=40.8669
 ICSTM CIA> cam_src_locate, ra, dec, raster, i, j, scd
 ICSTM CIA> !p.multi=[0,1,2]
 ICSTM CIA> cam_src_plot,round(i(0)),round(j(0)),scd(0),raster
 ICSTM CIA> cam_src_plot,round(i(1)),round(j(1)),scd(1),raster

 MODIFICATION HISTORY:
 	Written by:	Seb Oliver, 19th September 1996
	Added return where no matches found S Serjeant 3 Aug 1998
   06 aug 1998: disto keyword added to allow for field distortions Seb Oliver
	
</PRE><P>
<STRONG>(See /contrib-linux/rsi/idl_5.4/icstm_idl/astrom/cam_src_locate.pro)</STRONG><P>
<HR>
 
<A NAME="COMPUTE_DISTORTION">
<H2>COMPUTE_DISTORTION</H2></A>
<A HREF="#CAM_SRC_LOCATE">[Previous Routine]</A>
<A HREF="#ELAIS_NAME">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 NAME: 
    COMPUTE_DISTORTION
 PURPOSE:
  it computes xd and yd, coordinates with distortion
   the coefficients of the polynome:
     xd  = polynomes(0,0) + polynomes(1,0)*x +
             polynomes(2,0)*y + polynomes(3,0)* x*x +
             polynomes(4,0)*x*y + polynomes(5,0)* y*y +
             polynomes(6,0)*x*x*x + polynomes(7,0)*x*x*y +
             polynomes(8,0)*x*y*y + polynomes(9,0)*y*y*y 

     yd  = polynomes(0,1) + polynomes(1,1)*x +
             polynomes(2,1)*y + polynomes(3,1)* x*x +
             polynomes(4,1)*x*y + polynomes(5,1)* y*y +
             polynomes(6,1)*x*x*x + polynomes(7,1)*x*x*y +
             polynomes(8,1)*x*y*y + polynomes(9,1)*y*y*y 


 CATEGORY: 
    II-6 internal
 CALLING SEQUENCE:
    COMPUTE_DISTORTION, x, y, xpolynom, ypolynom, xd, yd
 INPUTS:
   x -- float  : the x coordinate
   y -- float  : the x coordinate
   XPOLYNOM -- fltarr(10) : the coefficient of the x polynome
   YPOLYNOM -- fltarr(10) : the coefficient of the x polynome

 OUTPUTS:
   xd -- float  : the x coordinate
   yd -- float  : the x coordinate

 SEE ALSO
    ISO_astr.cc, xy2ad
 MODIFICATION HISTORY:
     13-AUG-1997 R Gastaud  from H Aussel created 
                  COMPUTE_DISTORSION.PRO
     06-Oct-1997 D Landriu  renamed it 
      6-Aug-1998 Seb Oliver,  computation speeded up by calculating powers at begining

 COPYRIGHT:

 This routine belongs to the ISOCAM Interactive Analysis Package CIA.

 CIA is a joint development by the ESA Astrophysics Division and the ISOCAM
 Consortium led by the ISOCAM PI, C. Cesarsky, Direction des Sciences de la
 Matiere, C.E.A., France.
 Contributing ISOCAM Consortium institutes are Service d'Astrophysique (SAp,
 Saclay, France) and Institut d'Astrophysique Spatiale (IAS, Orsay, France)

 When publishing ISOCAM Data reduced with this analysis package, please
 mention this in the acknowledgement the following way:
   "The ISOCAM data presented in this paper was analysed using "CIA",
    a joint development by the ESA Astrophysics Division and the ISOCAM
    Consortium led by the ISOCAM PI, C. Cesarsky, Direction des Sciences de la
    Matiere, C.E.A., France. "

 Its use and distribution to authorised sites are free, as long as this header
 text is not removed, or changed.

 No warranties for installation/ support/ maintenance are given.
</PRE><P>
<STRONG>(See /contrib-linux/rsi/idl_5.4/icstm_idl/astrom/compute_distortion.pro)</STRONG><P>
<HR>
 
<A NAME="ELAIS_NAME">
<H2>ELAIS_NAME</H2></A>
<A HREF="#COMPUTE_DISTORTION">[Previous Routine]</A>
<A HREF="#GCIRC">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 NAME:
	elais_name

 PURPOSE:
	generates official ELAIS source names from a
       list of RAs and DECs

 CATEGORY:
	analysis

 CALLING SEQUENCE:
	elais_name(ra,dec[,band])

 INPUTS:
	ra:   RA(J2000) in degrees
       dec: DEC(J2000) in degrees

 OPTIONAL INPUTS:
	band: character string specifying bandwidth (default C15)
	
 KEYWORD PARAMETERS:
	

 OUTPUTS:
	elais_name: vector of offical elais names

 OPTIONAL OUTPUTS:
	

 COMMON BLOCKS:
	

 SIDE EFFECTS:
	

 RESTRICTIONS:
	

 PROCEDURE:
	follows IAU namining convention as in

 <a href="http://cdsweb.u-strasbg.fr/iau-spec.html"><http://cdsweb.u-strasbg.fr/iau-spec.html</a>

 EXAMPLE:
	

 MODIFICATION HISTORY:
 	Written by:	Seb Oliver 24th September 1996
       march '97: fixed bug if only one element supplied (SJO)
       name prefix convention changed in accordance with consortium
       meeting (SJO) 29th June 1998.
       prefix keyword added (Seb 20th Aug 1999)
	July, 1996	
</PRE><P>
<STRONG>(See /contrib-linux/rsi/idl_5.4/icstm_idl/astrom/elais_name.pro)</STRONG><P>
<HR>
 
<A NAME="GCIRC">
<H2>GCIRC</H2></A>
<A HREF="#ELAIS_NAME">[Previous Routine]</A>
<A HREF="#GSSSPUTAST">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 NAME:
       GCIRC
 PURPOSE:
       Computes rigorous great circle arc distances.  All computations
       are double precision.

 CALLING SEQUENCE:
       GCIRC, U, RA1, DC1, RA2, DC2, DIS

 INPUTS:
       U    -- Describes units of inputs and output:
               0:  everything radians
               1:  RAx in decimal hours, DCx in decimal
                       degrees, DIS in arc seconds 
       RA1  -- Right ascension of point 1
       DC1  -- Declination of point 1
       RA2  -- Right ascension of point 2
       DC2  -- Declination of point 2

   OUTPUTS:
       DIS  -- Angular distance on the sky between points 1 and 2
               See U above for units;  double scalar  

   PROCEDURE:
       "Cosine formula" (p. 7 of Smart's Spherical Astronomy or
       p. 12 of Green's Spherical Astronomy)

   NOTES:
       (1) Either RA1,DC1 or RA2,DC2 (but not both coordinates) can
       be vectors. In this case DIS is a vector giving the angular
       distance between each of the vector coordinates to the scalar
       coordinate.
       (2) Coordinates closer together than a few milliarcsec cannot
       be distinguished.  If you are in this realm, you should be
       using special-purpose algorithms.

   PROCEDURE CALLS:
	ISARRAY()

   MODIFICATION HISTORY:
       Written in Fortran by R. Hill -- SASC Technologies -- January 3, 1986
       Translated from FORTRAN to IDL, RSH, STX, 2/6/87
       Vector arguments allowed    W. Landsman    April 1989
       Prints result if last argument not given.  RSH, RSTX, 3 Apr. 1998
	Converted to IDL V5.0                      April 1998
       now runs on vectors of RA1 & DEC1 or RA2 & DEC2 Seb Oliver
       April 23 1999 (not rigerously tested)
       
</PRE><P>
<STRONG>(See /contrib-linux/rsi/idl_5.4/icstm_idl/astrom/icgcirc.pro)</STRONG><P>
<HR>
 
<A NAME="GSSSPUTAST">
<H2>GSSSPUTAST</H2></A>
<A HREF="#GCIRC">[Previous Routine]</A>
<A HREF="#GSS_PUTAST">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 NAME:
       GSSSPUTAST
 PURPOSE:
       Put astrometry parameters into a given FITS header.

 CALLING SEQUENCE:
       gsssputast, hdr, astr, [EQUINOX]

 INPUTS:
       HDR -  FITS header, string array.   HDR will be updated to contain
               the supplied astrometry.
       ASTR - IDL structure containing values of the GSSS astrometry parameters
              See GSSEXTAST for more info about the structure definition
                            or

 OUTPUTS:
       HDR - FITS header now contains the updated astrometry parameters
               A brief HISTORY record is also added.

 OPTIONAL KEYWORD INPUTS:
       EQUINOX - numeric scalar giving equinox (e.g. 2000) of the reference 
                coordinates 


 NOTES:

 PROMPTS:

 PROCEDURES USED:
    SXADDPAR, SXPAR, zparcheck, sixty
 REVISION HISTORY:
     Original Version, Seb Oliver (ICSTM) 4th August 1998.

 EXAMPLE:

 IDL> im=readfits('AFGL_4463S.fits.gz',hd)
 IDL> hd2=[hd[0:5],hd[106]]
 IDL> gsssextast,hd,a
 IDL> gsssputast,hd2,a
 IDL> gsssextast,hd2,a2
</PRE><P>
<STRONG>(See /contrib-linux/rsi/idl_5.4/icstm_idl/astrom/gsssputast.pro)</STRONG><P>
<HR>
 
<A NAME="GSS_PUTAST">
<H2>GSS_PUTAST</H2></A>
<A HREF="#GSSSPUTAST">[Previous Routine]</A>
<A HREF="#ICAD2XY">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 NAME:
       GSS_PUTAST
 PURPOSE:
       Put astrometry parameters into a given FITS header.

 CALLING SEQUENCE:
       gss_putast, hdr, astr, [EQUINOX]

 INPUTS:
       HDR -  FITS header, string array.   HDR will be updated to contain
               the supplied astrometry.
       ASTR - IDL structure containing values of the GSSS astrometry parameters
              See GSSEXTAST for more info about the structure definition
                            or

 OUTPUTS:
       HDR - FITS header now contains the updated astrometry parameters
               A brief HISTORY record is also added.

 OPTIONAL KEYWORD INPUTS:
       EQUINOX - numeric scalar giving equinox (e.g. 2000) of the reference 
                coordinates 

               As of September 1997, there is still no general agreement on
               the notation to use for the CD matrix; however form (0) will 
               almost certainly not be used.   In addition, since form
               (2) is used for HST images, it almost certainly will be 
               supported in the future.     The document "Representations of 
               Celestial Coordinates in FITS" by Griesen and Calabretta at   
               http://www.cv.nrao.edu/fits/documents/wcs/wcs.html discusses
               these issues but note this is only a draft.
               If CD_TYPE is not supplied, GSS_PUTAST will try to determine the 
               type of astrometry already in the header.   If there is no 
               astrometry in the header then the default is CD_TYPE = 2
 NOTES:
       The recommended use of this procedure is to supply an astrometry
       structure.    

 PROMPTS:
       If only a header is supplied, the user will be prompted for a plate 
       scale, the X and Y coordinates of a reference pixel, the RA and
       DEC of the reference pixel, the equinox of the RA and Dec and a 
       rotation angle.

 PROCEDURES USED:
       DATATYPE(), GET_COORDS, SXADDPAR, SXPAR(), ZPARCHECK
 REVISION HISTORY:

 EXAMPLE:

 IDL> im=readfits('AFGL_4463S.fits.gz',hd)
 IDL> hd2=hd
 IDL> gsssextast,hd,a
 IDL> gss_putast,hd2,a
 IDL> gsssextast,hd2,a2
</PRE><P>
<STRONG>(See /contrib-linux/rsi/idl_5.4/icstm_idl/astrom/gss_putast.pro)</STRONG><P>
<HR>
 
<A NAME="ICAD2XY">
<H2>ICAD2XY</H2></A>
<A HREF="#GSS_PUTAST">[Previous Routine]</A>
<A HREF="#ICBACKGROUND">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 NAME: 
       ICAD2XY
	

 PURPOSE:
	Compute and X and Y position given a FITS header and A and D
       able to handle GSS astrometry

 CATEGORY:
	

 CALLING SEQUENCE:
	ICAD2XY, a, d, HD, x, y

 INPUTS:
	A:  Longitude in degrees (scalar or vector)
       D:  Latitude in degrees  (scalar or vector)
      HD:  Fits header

 OPTIONAL INPUTS:
	
	
 KEYWORD PARAMETERS:
	

 OUTPUTS:
       X:  Row position (IDL convention)
       Y:  Col position (IDL convention)

 OPTIONAL OUTPUTS:
	

 COMMON BLOCKS:
	

 SIDE EFFECTS:
	

 RESTRICTIONS:
	

 PROCEDURE:
	

 EXAMPLE:
	

 MODIFICATION HISTORY:
 	Written by:	Seb Oliver July 1 1996
	July, 1994	Any additional mods get described here.
</PRE><P>
<STRONG>(See /contrib-linux/rsi/idl_5.4/icstm_idl/astrom/icad2xy.pro)</STRONG><P>
<HR>
 
<A NAME="ICBACKGROUND">
<H2>ICBACKGROUND</H2></A>
<A HREF="#ICAD2XY">[Previous Routine]</A>
<A HREF="#ICCAM_MKHDR">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 NAME:
	icbackground

 PURPOSE:
	gives the background from the IC models at and given positions
       and dates.

 CATEGORY:
	analysis

 CALLING SEQUENCE:
	rad_prof,im,[x0,y0,head],dist=dist

 INPUTS:
	im: image

 OPTIONAL INPUTS:
	
       x0: x position in image coordinates or RA if header passed
       y0: y position in image coordinates or Dec if header passed
         : if x0 and y0 not passed images maximum is used
	
 KEYWORD PARAMETERS:
	dist: the distance to each pixel

 OUTPUTS:
	

 OPTIONAL OUTPUTS:
	

 COMMON BLOCKS:
	

 SIDE EFFECTS:
	

 RESTRICTIONS:
	

 PROCEDURE:
	

 EXAMPLE:
	im=readfits('filename',hd)
       rad_prof,im,dist=dist,12.5d0,32.0,hd
       plot,dist,im,psym=3,/ystyle

 MODIFICATION HISTORY:
 	Written by:	Seb Oliver 13th Dec 1996
	July, 1996	
</PRE><P>
<STRONG>(See /contrib-linux/rsi/idl_5.4/icstm_idl/astrom/rad_prof.pro)</STRONG><P>
<HR>
 
<A NAME="ICCAM_MKHDR">
<H2>ICCAM_MKHDR</H2></A>
<A HREF="#ICBACKGROUND">[Previous Routine]</A>
<A HREF="#ICHASTROM">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 NAME:
	ICCAM_MKHDR

 PURPOSE:
	Makes a proper FITS header for a single CAM frame

 CATEGORY:
	

 CALLING SEQUENCE:
	ICCAM_MKHDR, RA, DEC, ROLL, HD

 INPUTS:
       RA:    ISO RA in degrees
       DEC:   ISO DEC in degrees
	ROLL:  ISO ROLL paramter

 OPTIONAL INPUTS:

	
 KEYWORD PARAMETERS:
	NAXIS1=NAXIS1: Number of pixels in x-axis (Default=32)
	NAXIS2=NAXIS2: Number of pixels in y-axis (Default=32)
	FLIPJ:  If set to 1 Astrometry is calculated assuming J-axis is
               flipped w.r.t the natural CAM orienation
               If unset of -1 then natural CAM orientation used 
       EQUINOX: Equinox of Astrometry (default 2000)
       pfov:  Pixel Field of view in arc seconds (Default 6")

 OUTPUTS:
	HD: FITS header with appropriate astrometric keywords

 OPTIONAL OUTPUTS:
	Describe optional outputs here.

 COMMON BLOCKS:
	BLOCK1:	Describe any common blocks here.

 SIDE EFFECTS:
	Describe "side effects" here.

 RESTRICTIONS:
	Describe any "restrictions" here.

 PROCEDURE:
	Sets up a header which rotates the i-axis to the RA axis
       and then flips the DEC axis if necessary.  N.B. the
       rotation is in the opposite sense from ROLL if in
       natural CAM coordinates.
       Could be improved by checking which coordinate is
       varying most and ajusting CTYPE and CRVAL accordingly.

 EXAMPLE:
	Please provide a simple example here.

 MODIFICATION HISTORY:
 	Written by:	Seb Oliver 23-May-1996
	June, 1996	Error handling and EQUINOX added
       June, 1996      renamed ICCAM_MKHDR
       26 Nov 1998:    pfov keyword added.
       13th May 1999:  Bug fixed so that repeated calls with
                       flipj=flipj when flipj starts off at 0 
                       did not change to the opposite sense
                       since flipj ends up "set" to -1 
                      
</PRE><P>
<STRONG>(See /contrib-linux/rsi/idl_5.4/icstm_idl/astrom/iccam_mkhdr.pro)</STRONG><P>
<HR>
 
<A NAME="ICHASTROM">
<H2>ICHASTROM</H2></A>
<A HREF="#ICCAM_MKHDR">[Previous Routine]</A>
<A HREF="#ICMKHDR">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 NAME:
	ICHASTROM
 PURPOSE:
	Linear transformation of an image to align it with a reference image
 EXPLANATION:
	A linear transformation is applied (using POLY_2D) to an image so that   
	its astrometry is identical with that in a reference header.  This
	procedure can be used to align two images.

 CALLING SEQUENCE:
	ICHASTROM, oldim, oldhd, newim, newhd, refhd, [MISSING =, INTERP = ]
		or
	ICHASTROM, oldim, oldhd, refhd, [MISSING =, INTERP =, NGRID =, CUBIC =]

 INPUTS:
	OLDIM - Image array to be manipulated.  If only 3 parameters are
		supplied then OLDIM and OLDHD will be modified to contain 
		the output image array and header
	OLDHD - FITS header array for OLDIM, containing astrometry parameters
	REFHD - Reference header, containing astrometry parameters.  OLDIM
		will be rotated, shifted, and compressed or expanded until
		its astrometry matches that in REFHD.
 OUTPUTS:
	NEWIM - Image array after linear tranformation has been performed.
		The dimensions of NEWIM will be identical to the NAXIS1 and 
		NAXIS2 keywords specified in REFHD.  Regions on the reference 
		image that do not exist in OLDIM can be assigned a value with
		the MISSING keyword.
	NEWHD - Updated FITS image header associated with NEWIM

 OPTIONAL INPUT KEYWORDS:
	MISSING - Set this keyword to a scalar value which will be assigned
		to pixels in the output image which do not correspond to 
		existing imput images.  If not supplied then linear 
		extrapolation is used.   See the IDL manual on POLY_2D.
	INTERP - Scalar, one of -1, 1, or 2 determining type of interpolation
		-1 nearest neighbor, 1 (default) bilinear interpolation, 
		2 cubic interpolation.
	CUBIC -  a scalar value between -1 and 0 specifying cubic interpolation
		with the specified value as the cubic interpolation parameter.
		(see poly_2d for info).    Setting CUBIC to a value greater 
		than zero is equivalent to setting CUBIC = -1. 
	NGRID -  Integer scalar specifying the number of equally spaced grid 
		points on each axis to use to specify the transformation.   
		Default is GRID = 3 (9 total grid points).     The value of
		GRID must always be greater than DEGREE + 1
	DEGREE - Integer scalar specifying the degree of the transformation.
		See the routine POLYWARP for more info.   Default = 1
		(linear transformation).

 NOTES:
	(1) The 3 parameter calling sequence is less demanding on virtual 
		memory.
	(2) The astrometry in OLDHD will be precessed to match the equinox
		given in REFHD.

 EXAMPLE:
	Suppose one has an image array, IM, and an associated FITS header H.
	One desires to warp the image array so that it is aligned with another
	image with a FITS header, HREF.    Both headers contain astrometry info.
	Set pixel values to 0 where there is no overlap between the input and
	reference image, and use linear interpolation (default)

           IDL> ichastrom, IM, H, HREF, MISSING = 0

 PROCEDURES USED:
	zparcheck, check_FITS, sxpar(), get_EQUINOX(), hprecess, extast,
	sxaddpar, sxaddhist, putast

 REVISION HISTORY:
	Written  W. Landsman, STX Co.              Feb, 1989
	Updated to CHECK_FITS                      Dec, 1991
	New astrometry keywords                    Mar, 1994
	Recognize GSSS header   W. Landsman        June, 1994
	Added CUBIC keyword     W. Landsman        March, 1997
	Converted to IDL V5.0   W. Landsman   September 1997
       Fixed so INTERP=-1 uses nearest neighbour    Seb Oliver August 1998
       Fixed so PUTAST is not called if GSS astrom. Seb Oliver August 1998
       Disto keyword added to allow correction for CAM distortions Seb Oliver August 1998

 Seb Oliver December 1999
       Optional Perturbation added to polywarp as it does not
       seem to work correctly with small images 
       the current fix appears to work going from big pixels to small
       pixels (if delt=+0.5), but not the other way around which
       appears to be sensitive to the roll angles.  A routine
       for testing this is appended in case anyone else can solve
       this problem

 EXAMPLE:

 IDL> im=readfits('AFGL_4463S.fits.gz',hd)
 IDL> hd2=hd
 IDL> im2=im+100
 IDL> GSSS_STDAST, hd2
 IDL> hrotate,im2,hd2,1
 IDL> ichastrom,im2,hd2,im3,hd3,hd,interp=-1
 IDL>  hrotate,im2,hd2,1
 IDL>  hrotate,im2,hd2,1
 IDL>  hrotate,im2,hd2,1


</PRE><P>
<STRONG>(See /contrib-linux/rsi/idl_5.4/icstm_idl/astrom/ichastrom.pro)</STRONG><P>
<HR>
 
<A NAME="ICMKHDR">
<H2>ICMKHDR</H2></A>
<A HREF="#ICHASTROM">[Previous Routine]</A>
<A HREF="#ICSCAN">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 NAME:
	ICMKHDR

 PURPOSE:
	Makes a  FITS header with simple astrometry

 CATEGORY:
	

 CALLING SEQUENCE:
	ICMKHDR, NAXIS1, NAXIS2,  CDELT1, CDELT2, RA, DEC, ROLL, HD, $
                equinox=equinox, crpix=crpix

 INPUTS:
       NAXIS1: Number of pixels on axis 1
       NAXIS2: Number of pixels on axis 2
       CDELT1: FITS parameter
       CDELT1: FITS parameter
       RA:    RA in degrees
       DEC:   DEC in degrees
	ROT:  ROT paramter

 KEYWORDS:
       EQUINOX: Equinox of Astrometry (default 2000)
       CRPIX: 2 element vector giving FITS reference pixel
       DETECTOR: If set then image is a view onto the detector
                 rather than onto the sky e.g. for CAM

 OUTPUTS:
	HD: FITS header with appropriate astrometric keywords

 OPTIONAL OUTPUTS:
	Describe optional outputs here.

 COMMON BLOCKS:
	BLOCK1:	Describe any common blocks here.

 SIDE EFFECTS:
	Describe "side effects" here.

 RESTRICTIONS:
	Describe any "restrictions" here.

 PROCEDURE:


 EXAMPLE:
	Please provide a simple example here.

 MODIFICATION HISTORY:
 	Written by:	Seb Oliver 23-July-1996 (adapted from ICCAM_MKHDR)
	June, 1996	
       June, 1996      
</PRE><P>
<STRONG>(See /contrib-linux/rsi/idl_5.4/icstm_idl/astrom/icmkhdr.pro)</STRONG><P>
<HR>
 
<A NAME="ICSCAN">
<H2>ICSCAN</H2></A>
<A HREF="#ICMKHDR">[Previous Routine]</A>
<A HREF="#ICSCANRD">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 NAME:
	ICSCAN

 PURPOSE:
	Construct a scan from a supplied image and the ISO pointing history.

 CALLING SEQUENCE:
	icscan ,imf ,iiph ,scan [,time]

 INPUTS:
	imf:	FITS file containing image
	iiph:	FITS file containing ISO pointing history (IIPH).

 OUTPUTS:
	scan:	Array containing the scan measurements

 OPTIONAL OUTPUTS:
	time:	Array containing the time of the measurements

 RESTRICTIONS:
	The image file must have an equinox defined

 EXAMPLE:
	icscan, 'iras100.fit', 'iiph.fit', scan, time     Extract scan
	plot, time, scan                                  Plot time vs scan

 MODIFICATION HISTORY:
 	Written by:	Nick Eaton  28 Jun 1996
</PRE><P>
<STRONG>(See /contrib-linux/rsi/idl_5.4/icstm_idl/astrom/icscan.pro)</STRONG><P>
<HR>
 
<A NAME="ICSCANRD">
<H2>ICSCANRD</H2></A>
<A HREF="#ICSCAN">[Previous Routine]</A>
<A HREF="#ICSTARAST">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 NAME:
	ICSCANRD

 PURPOSE:
	Construct a scan from an image and a list of RA's and Dec's.

 CALLING SEQUENCE:
	icscanrd ,im ,head ,ra ,dec ,scan

 INPUTS:
	im:	data array containing image (e.g. from readfits)
	head:	FITS file header (e.g. from readfits)
       ra:	array of Right Ascension's
       dec:	array of Declination's

 OUTPUTS:
	scan:	array containing the scan measurements

 SIDE EFFECTS:
	The output array is zero where positions lie outside the image.

 RESTRICTIONS:
	The Ra's and Dec's must be for the same equinox as the image

 EXAMPLE:
	im = readfits( 'iras100.fit', head )    Read in fits file
	icscanrd, im, head, ra, dec, scan       Extract scan given positions
	plot, scan                              Plot scan

 MODIFICATION HISTORY:
 	Written by:	Nick Eaton  30 Jun 1996
       16th December 1996 allows multi dimensional coordinate input Seb Oliver
</PRE><P>
<STRONG>(See /contrib-linux/rsi/idl_5.4/icstm_idl/astrom/icscanrd.pro)</STRONG><P>
<HR>
 
<A NAME="ICSTARAST">
<H2>ICSTARAST</H2></A>
<A HREF="#ICSCANRD">[Previous Routine]</A>
<A HREF="#ICSTRINGAD">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 NAME:
       ICSTARAST

 PURPOSE:
       Finds a least squares astrometric solution for an 
       array of x,y and ra,dec positions. Generalises the
       astrolib routine starast to >3 objects.

 CALLING SEQUENCE:
       icstarast, x, y, ra, dec, cd, crval, crpix

 INPUTS:
       x, y: arrays of star positions in pixel coords
       ra, dec: right ascension and declination of stars

 OPTIONAL INPUTS:
       equinox: equinox for header
       naxis1: dimension 1 of image for header
       naxis2: dimension 2 of image for header

 KEYWORD PARAMETERS:
       none

 OUTPUTS:
       cd, crval, crpix: fits header parameters
       
 OPTIONAL OUTPUTS:
       header: fits header
       
 EXAMPLE:
       icstarast, x, y, ra, dec, cd, crval, crpix

 MODIFICATION HISTORY:
       Written by:     Stephen Serjeant  11 Mar 1997
          Any modifications get described here
	version 2: naxis1 and naxis2 added, calling sequence retur, etc - SS
</PRE><P>
<STRONG>(See /contrib-linux/rsi/idl_5.4/icstm_idl/astrom/icstarast.pro)</STRONG><P>
<HR>
 
<A NAME="ICSTRINGAD">
<H2>ICSTRINGAD</H2></A>
<A HREF="#ICSTARAST">[Previous Routine]</A>
<A HREF="#ICXY2AD">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 NAME:
	ICSTRINGAD
 PURPOSE:
	Converts a string of sexigesimal coordinates into decimal degrees.

 CALLING SEQUENCE:
	ICSTRINGAD, COORDS, RA, DEC [,IWARN=IWARN]
 INPUT:
	COORDS    A string of coordinates (e.g. '17 00 45.2 25 4 32.4')
		It should have six numbers delimited by spaces or colons
 OUTPUT:
	RA        Right Ascension, decimal degrees, scalar
	DEC       Declination, decimal degrees, scalar
	IWARN     (Optional) Set to 1 if any mins or secs > 60
 PROCEDURES CALLED:
	Getopt   Ten
 HISTORY:
	09-AUG-90 Version 1 written by Kerry McQuade
	20-AUG-90 Put code to account for '-0' back in after it was
		removed by someone.  E. Deutsch
	17-JUL-95 Added support for coordinates separated by colons, e.g.
		17:00:45.2 25:4:32.4, which IRAF uses.  E. Deutsch
	21 Aug 98: Renamed icstringad, added check for >60mins or >60 secs
		and iwarn keyword. Also no longer modifies input
		and supports vector arguments. 
		Steve Serjeant ICSTM
</PRE><P>
<STRONG>(See /contrib-linux/rsi/idl_5.4/icstm_idl/astrom/icstringad.pro)</STRONG><P>
<HR>
 
<A NAME="ICXY2AD">
<H2>ICXY2AD</H2></A>
<A HREF="#ICSTRINGAD">[Previous Routine]</A>
<A HREF="#IIPH_POINTING_ASTROMETRY">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 NAME: 
        ICXY2AD
	

 PURPOSE:
	Compute a Lat  and LONG position given a FITS header and (X,Y)
       able to handle GSS astrometry

 CATEGORY:
	

 CALLING SEQUENCE:
	ICXY2AD, x, y, HD, a, d

 INPUTS:
       X:  Row position (IDL convention)
       Y:  Col position (IDL convention)
      HD:  Fits header

 OPTIONAL INPUTS:
	
	
 KEYWORD PARAMETERS:
	

 OUTPUTS:
	A:  Longitude in degrees (scalar or vector)
       D:  Latitude in degrees  (scalar or vector)

 OPTIONAL OUTPUTS:
	

 COMMON BLOCKS:
	

 SIDE EFFECTS:
	

 RESTRICTIONS:
	

 PROCEDURE:
	

 EXAMPLE:
	

 MODIFICATION HISTORY:
 	Written by:	Seb Oliver July 1 1996
	July, 1994	Any additional mods get described here.
       6 aug 1998 Seb Oliver modifed to allow field distortion option
</PRE><P>
<STRONG>(See /contrib-linux/rsi/idl_5.4/icstm_idl/astrom/icxy2ad.pro)</STRONG><P>
<HR>
 
<A NAME="IIPH_POINTING_ASTROMETRY">
<H2>IIPH_POINTING_ASTROMETRY</H2></A>
<A HREF="#ICXY2AD">[Previous Routine]</A>
<A HREF="#IRPH2AST">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 NAME:
       IIPH_POINTING_ASTROMETRY

 PURPOSE:
       CALCULATES THE RA AND DEC OF A POINTING
       FROM THE MEDIAN IIPH RA AND DEC WITHIN A GIVEN RADIUS
       OF RASTER.INFO.RA
       AND RASTER.INFO.DEC FOR THE POINTING

 CALLING SEQUENCE:
       iiph_pointing_astrometry,iiph,raster,new_ra,new_dec,$
        scd_list=scd_list,radius=radius

 INPUTS:
       iiph: structure (obtained eg from read_extended_fits)
       raster: structure

 OPTIONAL INPUTS:
       scd_list: intarr - list of scds to find astrometry for
       radius: search radius in arsec (default 40'') - for ISO-HDF use 3''

 KEYWORD PARAMETERS:
       none

 EXAMPLE:
       dir='/iso/pipe2/p0032282/23200251'
       cd,dir
       fitsname='iiph.fit'
       read_extended_fits,FITSname ,dir= dir, header,iiph, ack=ok;
       restore,'rassrc4232002510_97020323161000.cub'
 
       iiph_pointing_astrometry,iiph,raster,$
       correct_ra,correct_dec,radius=30,scd_list=[0,1,2,3,229,236,243]

 MODIFICATION HISTORY:
       Written by:     Stephen Serjeant  April 1997
		25 Aug 1998: Added history keyword and param check S Serjeant
</PRE><P>
<STRONG>(See /contrib-linux/rsi/idl_5.4/icstm_idl/astrom/iiph_pointing_astrometry.pro)</STRONG><P>
<HR>
 
<A NAME="IRPH2AST">
<H2>IRPH2AST</H2></A>
<A HREF="#IIPH_POINTING_ASTROMETRY">[Previous Routine]</A>
<A HREF="#ISOHDF_NAME">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 NAME:
	IRPH2AST

 PURPOSE:
	Construct astrometry parameters from an IRPH file.
	The output astrometry is in CD format.

 CALLING SEQUENCE:
	irph2ast, irph, astr

 INPUTS:
	irph - Filename of IRPH file

 OUTPUTS:
	astr - Anonymous structure continaing astrometry info
   	 .CD   -  2 x 2 array containing the astrometry parameters CD1_1 CD1_2
		in DEGREES/PIXEL                                   CD2_1 CD2_2
	 .CDELT - 2 element vector giving physical increment at reference pixel
	 .CRPIX - 2 element vector giving X and Y coordinates of reference pixel
		(def = NAXIS/2)
	 .CRVAL - 2 element double precision vector giving R.A. and DEC of 
		reference pixel in DEGREES
	 .CTYPE - 2 element string vector giving projection types, default
		['RA---TAN','DEC--TAN']
	 .LONGPOLE - scalar longitude of north pole (default = 180) 
        .PROJP1 - Scalar parameter needed in some projections
	 .PROJP2 - Scalar parameter needed in some projections

       ra, dec, roll - coordinates of the raster pointings

 RESTRICTIONS:
	The ctype, longpole and projp parameters have hardwired values.

 EXAMPLE:
	makeast,'irph.fit',a

 MODIFICATION HISTORY:
 	Written by:	Nick Eaton  27/1/97
       July 1999       Seb Oliver ra, dec & roll returned
	July, 1994	Any additional mods get described here.
</PRE><P>
<STRONG>(See /contrib-linux/rsi/idl_5.4/icstm_idl/astrom/irph2ast.pro)</STRONG><P>
<HR>
 
<A NAME="ISOHDF_NAME">
<H2>ISOHDF_NAME</H2></A>
<A HREF="#IRPH2AST">[Previous Routine]</A>
<A HREF="#MAKE_STAMPS">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 NAME:
	isohdf_name

 PURPOSE:
	generates official ISOHDF source names from a
       list of RAs and DECs

 CATEGORY:
	analysis

 CALLING SEQUENCE:
	isohdf_name(ra,dec[,inst])

 INPUTS:
	ra:   RA(J2000) in degrees
       dec: DEC(J2000) in degrees

 OPTIONAL INPUTS:
	inst: character string specifying instrument (Default 'CAM')
	
 KEYWORD PARAMETERS:
	

 OUTPUTS:
	isohdf_name: vector of offical isohdf names

 OPTIONAL OUTPUTS:
	

 COMMON BLOCKS:
	

 SIDE EFFECTS:
	

 RESTRICTIONS:
	

 PROCEDURE:
	follows IAU namining convention as in

 <a href="http://cdsweb.u-strasbg.fr/iau-spec.html"><http://cdsweb.u-strasbg.fr/iau-spec.html</a>

 EXAMPLE:
	

 MODIFICATION HISTORY:
 	Written by:	Seb Oliver 24th September 1996
	July, 1996	
</PRE><P>
<STRONG>(See /contrib-linux/rsi/idl_5.4/icstm_idl/astrom/isohdf_name.pro)</STRONG><P>
<HR>
 
<A NAME="MAKE_STAMPS">
<H2>MAKE_STAMPS</H2></A>
<A HREF="#ISOHDF_NAME">[Previous Routine]</A>
<A HREF="#MULTADSTRING">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 NAME:
	MAKE_STAMPS

 PURPOSE:
	Make postage stamp images from a FITS image and some positions.

 CALLING SEQUENCE:
	make_stamps, ifile, ofile, psize, ra, dec

 INPUTS:
	IFILE:	Name of FITS file containing image
	OFILE:	Prefix name of output FITS files
	PSIZE:	Size of postage stamps in degrees
	RA:	List of right ascensions (J2000)
	DEC:	List of declinations (J2000)

 SIDE EFFECTS:
	The postage stamps are put into FITS files with names prefixed
	by the OFILE parameter and ending '_##.fits' where ## is the
	number of the position in the list of positions

 RESTRICTIONS:
	Describe any "restrictions" here.

 EXAMPLE:
	Please provide a simple example here.

 MODIFICATION HISTORY:
 	Written by:	Nick Eaton,  15 Aug 1996
	17th August, 1996 Check that image has been created before writing
                         Seb Oliver
</PRE><P>
<STRONG>(See /contrib-linux/rsi/idl_5.4/icstm_idl/astrom/make_stamps.pro)</STRONG><P>
<HR>
 
<A NAME="MULTADSTRING">
<H2>MULTADSTRING</H2></A>
<A HREF="#MAKE_STAMPS">[Previous Routine]</A>
<A HREF="#MULTSTRINGAD">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 NAME:
	multadstring

 PURPOSE:
	runs adstring for vector input

 CATEGORY:
	analysis

 CALLING SEQUENCE:
	multadstring, ra, dec, sexi [,prec=prec,/hms]

 INPUTS:
	ra: vector of RAs (degrees)
      dec: vector of DECs  "

 OPTIONAL INPUTS:
	
	
 KEYWORD PARAMETERS:
	
     prec:  precision of string as for adstring function
      hms:  if set then an 00h00m00.0s +00d00m00.0s format is returned

 OUTPUTS:
    sexi:   sexigesimal formatted output	

 OPTIONAL OUTPUTS:
	

 COMMON BLOCKS:
	

 SIDE EFFECTS:
	

 RESTRICTIONS:
	

 PROCEDURE:
	

 EXAMPLE:
	

 MODIFICATION HISTORY:
 	Written by:	Seb Oliver 15th Aug 1996
       10 th dec 1996  hms keword added (doesn't works)
       4th June 1997 hms keyword fixed (but not precise)
	July, 1996	
</PRE><P>
<STRONG>(See /contrib-linux/rsi/idl_5.4/icstm_idl/astrom/multadstring.pro)</STRONG><P>
<HR>
 
<A NAME="MULTSTRINGAD">
<H2>MULTSTRINGAD</H2></A>
<A HREF="#MULTADSTRING">[Previous Routine]</A>
<A HREF="#PHTITK2UTK">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 NAME:
	multstringad

 PURPOSE:
	runs stringad for vector input

 CATEGORY:
	analysis

 CALLING SEQUENCE:
	multstringad, sexi, ra, dec

 INPUTS:
	

 OPTIONAL INPUTS:
	
	
 KEYWORD PARAMETERS:
	

 OUTPUTS:
	

 OPTIONAL OUTPUTS:
	

 COMMON BLOCKS:
	

 SIDE EFFECTS:
	

 RESTRICTIONS:
	

 PROCEDURE:
	

 EXAMPLE:
	

 MODIFICATION HISTORY:
 	Written by:	Seb Oliver 15th Aug 1996
       18-Nov-1996:    Replaces : with spaces
	10-Jul-1998:	works for long lists (Bob Mann)
</PRE><P>
<STRONG>(See /contrib-linux/rsi/idl_5.4/icstm_idl/astrom/multstringad.pro)</STRONG><P>
<HR>
 
<A NAME="PHTITK2UTK">
<H2>PHTITK2UTK</H2></A>
<A HREF="#MULTSTRINGAD">[Previous Routine]</A>
<A HREF="#PIX2IYIZ">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 NAME:
	PHTITK2UTK

 PURPOSE:
	Converts PHOT ITK to UTK

 CATEGORY:
	

 CALLING SEQUENCE:
	PHTITK2UTK, ITK, UTK, ICS

 INPUTS:
	ITK: PHOT Instrument Time Key
	ICS: Name of PHT ICS structure 

 OPTIONAL INPUTS:

	
 KEYWORD PARAMETERS:
	

 OUTPUTS:
       UTK: Universal Time Key
	

 OPTIONAL OUTPUTS:


 COMMON BLOCKS:


 SIDE EFFECTS:


 RESTRICTIONS:


 PROCEDURE:


 EXAMPLE:


 MODIFICATION HISTORY:
 	Written by:	Seb Oliver 5th August 1996
	July, 1994	Any additional mods get described here.
</PRE><P>
<STRONG>(See /contrib-linux/rsi/idl_5.4/icstm_idl/astrom/phtitk2utk.pro)</STRONG><P>
<HR>
 
<A NAME="PIX2IYIZ">
<H2>PIX2IYIZ</H2></A>
<A HREF="#PHTITK2UTK">[Previous Routine]</A>
<A HREF="#POSTAGE">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 NAME:
	pix2iyiz

 PURPOSE:
	Converts PHOT Pixel indicies into two element indicies
       incrementing allomg space-craft coordinates

 CATEGORY:
	

 CALLING SEQUENCE:
	pix2iyiz, ipix, iy, iz

 INPUTS:
	ipix:  Scalar or array of pixel indicies (0:8)

 OPTIONAL INPUTS:
	
	
 KEYWORD PARAMETERS:
	npix: number of pixels on x and y axis (i.e. 2 or 3 for c100/c200)

 OUTPUTS:
	iy: Scalar of array of same dimensions as ipix
           containing index along space craft Y-axis (0:2)
       iz: As above but along Space-craft Z-axis


 OPTIONAL OUTPUTS:
	

 COMMON BLOCKS:
	

 SIDE EFFECTS:
	

 RESTRICTIONS:
	

 PROCEDURE:
	

 EXAMPLE:
	

 MODIFICATION HISTORY:
 	Written by:	Seb Oliver 1st August 1996
       21st April 1998 npix keyword added
	July, 1994	Any additional mods get described here.
</PRE><P>
<STRONG>(See /contrib-linux/rsi/idl_5.4/icstm_idl/astrom/pix2iyiz.pro)</STRONG><P>
<HR>
 
<A NAME="POSTAGE">
<H2>POSTAGE</H2></A>
<A HREF="#PIX2IYIZ">[Previous Routine]</A>
<A HREF="#PUTAST">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 NAME:
	POSTAGE

 PURPOSE:
	Extracts a postage stamp image approximately centred on a cellestial
       position

 CATEGORY:
	Database tools

 CALLING SEQUENCE:
	POSTAGE, IM1, HD1, RA, DEC, IM2, HD2, PSIZE=PSIZE


 INPUTS:
	IM1:  Image from which to extract Postage stamp
       HD1:  Header of Image 1
       RA:   RA of target (Decimal Degrees) scalar
       DEC:  DEC of target (Decimal Degrees) scalar

 OPTIONAL INPUTS:
	
	
 KEYWORD PARAMETERS:
	PSIZE: Approximate  SIZE of postage stamp (Degrees), Default=0.05
       EQUINOX:  Equinox of RA and DEC (Default J2000)
 OUTPUTS:
	IM2: Postage stamp Image centred around target position
       HD2: FITS Header for postage stamp

 OPTIONAL OUTPUTS:
	

 COMMON BLOCKS:
	

 SIDE EFFECTS:
	

 RESTRICTIONS:
	Rotation of postage stamp is same as original image
       Image centre and size are to nearest pixel only
       Checked for GSSS astrometry only
       Ideally should work with vector input

 PROCEDURE:
	

 EXAMPLE:
	

 MODIFICATION HISTORY:
 	Written by:	Seb Oliver June 1996
	July, 1994	Any additional mods get described here.
</PRE><P>
<STRONG>(See /contrib-linux/rsi/idl_5.4/icstm_idl/astrom/postage.pro)</STRONG><P>
<HR>
 
<A NAME="PUTAST">
<H2>PUTAST</H2></A>
<A HREF="#POSTAGE">[Previous Routine]</A>
<A HREF="#READ_DISTORTION_FILE">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 NAME:
       PUTAST
 PURPOSE:
       Put astrometry parameters into a given FITS header.

 CALLING SEQUENCE:
       putast, hdr, astr, [EQUINOX =, CD_TYPE = ]
               or
       putast, hdr, cd,[ crpix, crval], [ EQUINOX =, CD_TYPE = ]

 INPUTS:
       HDR -  FITS header, string array.   HDR will be updated to contain
               the supplied astrometry.
       ASTR - IDL structure containing values of the astrometry parameters
              CDELT, CRPIX, CRVAL, CTYPE, LONGPOLE, PROJP1, and PROJP2
              See EXTAST.PRO for more info about the structure definition
                            or
       CD   - 2 x 2 array containing the astrometry parameters CD1_1 CD1_2
                                                               CD2_1 CD2_2
              in units of DEGREES/PIXEL
       CRPIX - 2 element vector giving X and Y coord of reference pixel
              BE SURE THE COORDINATES IN CRPIX ARE GIVEN IN FORTRAN STANDARD
              (e.g. FIRST PIXEL IN IMAGE IS (1,1) )
       CRVAL - 2 element vector giving R.A. and DEC of reference pixel 
               in degrees

 OUTPUTS:
       HDR - FITS header now contains the updated astrometry parameters
               A brief HISTORY record is also added.

 OPTIONAL KEYWORD INPUTS:
       EQUINOX - numeric scalar giving equinox (e.g. 2000) of the reference 
                coordinates 

       CD_TYPE - Scalar, either 0, 1 , or 2 specifying how the CD matrix
                is to be written into the header
               (0) as CD00n00m values 
               (1) convert to rotation and write as a CROTA2 value
               (2) as CDn_m value

               As of September 1997, there is still no general agreement on
               the notation to use for the CD matrix; however form (0) will 
               almost certainly not be used.   In addition, since form
               (2) is used for HST images, it almost certainly will be 
               supported in the future.     The document "Representations of 
               Celestial Coordinates in FITS" by Griesen and Calabretta at   
               http://www.cv.nrao.edu/fits/documents/wcs/wcs.html discusses
               these issues but note this is only a draft.
               If CD_TYPE is not supplied, PUTAST will try to determine the 
               type of astrometry already in the header.   If there is no 
               astrometry in the header then the default is CD_TYPE = 2
 NOTES:
       The recommended use of this procedure is to supply an astrometry
       structure.    

 PROMPTS:
       If only a header is supplied, the user will be prompted for a plate 
       scale, the X and Y coordinates of a reference pixel, the RA and
       DEC of the reference pixel, the equinox of the RA and Dec and a 
       rotation angle.

 PROCEDURES USED:
       DATATYPE(), GET_COORDS, SXADDPAR, SXPAR(), ZPARCHECK
 REVISION HISTORY:
       Written by W. Landsman 9-3-87
       Major rewrite, use new astrometry structure   March, 1994
       Use both CD and CDELT to get plate scale for CD_TYPE=1   September 1995
       Use lower case for FITS keyword Comments  W.L.    March 1997
       Fixed for CD_TYPE=1 and CDELT = [1.0,1.0]   W.L   September 1997
       Default value of CD_TYPE is now 2, Use GET_COORDS to read coordinates
       to correct -0 problem           W.L.  September 1997
       Update CROTA1 if it already exists  W.L. October 1997
       Convert rotation to degrees for CD_TYPE = 1  W. L.   June 1998
       Convert to IDL V5.0    W.L. June 1998
</PRE><P>
<STRONG>(See /contrib-linux/rsi/idl_5.4/icstm_idl/astrom/icputast.pro)</STRONG><P>
<HR>
 
<A NAME="READ_DISTORTION_FILE">
<H2>READ_DISTORTION_FILE</H2></A>
<A HREF="#PUTAST">[Previous Routine]</A>
<A HREF="#SBGS_PFOV">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 NAME: 
 READ_DISTORTION_FILE
 PURPOSE:
  it extracts from t the ascii distortion file the detector ID,
   the coefficients of the polynome:
     xdif  = polynomes(0,0) + polynomes(1,0)*x +
             polynomes(2,0)*y + polynomes(3,0)* x*x +
             polynomes(4,0)*x*y + polynomes(5,0)* y*y +
             polynomes(6,0)*x*x*x + polynomes(7,0)*x*x*y +
             polynomes(8,0)*x*y*y + polynomes(9,0)*y*y*y 

     ydif  = polynomes(0,1) + polynomes(1,1)*x +
             polynomes(2,1)*y + polynomes(3,1)* x*x +
             polynomes(4,1)*x*y + polynomes(5,1)* y*y +
             polynomes(6,1)*x*x*x + polynomes(7,1)*x*x*y +
             polynomes(8,1)*x*y*y + polynomes(9,1)*y*y*y 


 CATEGORY: 
 II-6 internal
 CALLING SEQUENCE:
    Polynomes = READ_DISTORTION_FILE( filename)
 INPUTS:
   filename -- string : name of the ascii distortion file
 OUTPUTS:
   Polynomes     -- fltarr(10,2) : the coefficients of the polynome

 SEE ALSO
    ISO_astr.cc, compute_distortion
 MODIFICATION HISTORY:
     13-AUG-1997 R Gastaud  created read_distorsion_file
     06-Oct-1997 D Landriu renamed it


 COPYRIGHT:

 This routine belongs to the ISOCAM Interactive Analysis Package CIA.

 CIA is a joint development by the ESA Astrophysics Division and the ISOCAM
 Consortium led by the ISOCAM PI, C. Cesarsky, Direction des Sciences de la
 Matiere, C.E.A., France.
 Contributing ISOCAM Consortium institutes are Service d'Astrophysique (SAp,
 Saclay, France) and Institut d'Astrophysique Spatiale (IAS, Orsay, France)

 When publishing ISOCAM Data reduced with this analysis package, please
 mention this in the acknowledgement the following way:
   "The ISOCAM data presented in this paper was analysed using "CIA",
    a joint development by the ESA Astrophysics Division and the ISOCAM
    Consortium led by the ISOCAM PI, C. Cesarsky, Direction des Sciences de la
    Matiere, C.E.A., France. "

 Its use and distribution to authorised sites are free, as long as this header
 text is not removed, or changed.

 No warranties for installation/ support/ maintenance are given.
</PRE><P>
<STRONG>(See /contrib-linux/rsi/idl_5.4/icstm_idl/astrom/read_distortion_file.pro)</STRONG><P>
<HR>
 
<A NAME="SBGS_PFOV">
<H2>SBGS_PFOV</H2></A>
<A HREF="#READ_DISTORTION_FILE">[Previous Routine]</A>
<A HREF="#WFPC2_2_MERLIN">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 NAME:
       SBGS_PFOV

 PURPOSE:
       This program takes pixel position arrays as input
       and outputs "true" positions once corrected for the field
       distortion. The CAM detector array is trapezoidal
       with the j=31 line longer than the j=0 line. 
       (WARNING: I've still to check that I have that the right way round!
       The columns
       are all assumed to have the same length. Thus, the pixel 
       (1,2) has a true position of about (1.2,2.0), and pixel(30,2) 
       has a true position of about (29.8,2.0). 
       The correction itself is from ISOCAM DATA CALIBRATION
       VERSION 1.0, Starck et al, March 13 1996
       PFOV = 6'' assumed. 

 CALLING SEQUENCE:
       sbgs_pfov, i, j, iprime, jprime

 INPUTS:
       i,j: arrays of pixel positions (intarr or fltarr)

 OPTIONAL INPUTS:
       none
       
 OUTPUTS:
       iprime,jprime: fltarrs of same size as i,j containing
                      corrected positions

 KEYWORD PARAMETERS:
       none

 EXAMPLE:
       sbgs_pfov, i, j, iprime, jprime

 MODIFICATION HISTORY:
       Written by:     Stephen Serjeant  Jan 1997
       Any additional modifications to be described here
</PRE><P>
<STRONG>(See /contrib-linux/rsi/idl_5.4/icstm_idl/astrom/sbgs_pfov.pro)</STRONG><P>
<HR>
 
<A NAME="WFPC2_2_MERLIN">
<H2>WFPC2_2_MERLIN</H2></A>
<A HREF="#SBGS_PFOV">[Previous Routine]</A>
<A HREF="#XY2AD">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 NAME:
	wfpc2_2_merlin

 PURPOSE:
	changes raw HDF WPFC2 positions to the Merlin reference Frame

 CATEGORY:
	analysis

 CALLING SEQUENCE:
	

 INPUTS:
	ra: either hours or degrees as long as within the local of HDF
      dec: in degrees

 OPTIONAL INPUTS:
	
	
 KEYWORD PARAMETERS:
	reverse: if set then the reverse transformation is performed

 OUTPUTS:
	
	ra: either hours or degrees as long as within the local of HDF
      dec: in degrees

 OPTIONAL OUTPUTS:
	

 COMMON BLOCKS:
	

 SIDE EFFECTS:
	

 RESTRICTIONS:
	

 PROCEDURE:
	

 EXAMPLE:
	

 MODIFICATION HISTORY:
 	Written by:	Seb Oliver 13th Dec 1996
	July, 1996	
</PRE><P>
<STRONG>(See /contrib-linux/rsi/idl_5.4/icstm_idl/astrom/wfpc2_2_merlin.pro)</STRONG><P>
<HR>
 
<A NAME="XY2AD">
<H2>XY2AD</H2></A>
<A HREF="#WFPC2_2_MERLIN">[Previous Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 NAME:
	XY2AD

 PURPOSE:
	Compute R.A. and Dec from X and Y and a FITS astrometry structure
 EXPLANATION:
	The astrometry structure must first be extracted by EXTAST from a FITS
	header.   A tangent (gnomonic) projection is computed directly; other
	projections are computed using WCSXY2SPH.   Angles are returned in 
	degrees.   XY2AD is meant to be used internal to other procedures.  
	For interactive purposes use XYAD.

 CALLING SEQUENCE:
	XY2AD, x, y, astr, a, d   

 INPUTS:
	X     - row position in pixels, scalar or vector
	Y     - column position in pixels, scalar or vector
	ASTR - astrometry structure, output from EXTAST procedure containing:
   	 .CD   -  2 x 2 array containing the astrometry parameters CD1_1 CD1_2
		in DEGREES/PIXEL                                   CD2_1 CD2_2
	 .CDELT - 2 element vector giving physical increment at reference pixel
	 .CRPIX - 2 element vector giving X and Y coordinates of reference pixel
		(def = NAXIS/2)
	 .CRVAL - 2 element vector giving R.A. and DEC of reference pixel 
		in DEGREES
	 .CTYPE - 2 element vector giving projection types 
	 .LONGPOLE - scalar longitude of north pole (default = 180) 
        .PROJP1 - Scalar parameter needed in some projections
	 .PROJP2 - Scalar parameter needed in some projections

 OUTPUT:
	A - R.A. in DEGREES, same number of elements as X and Y
	D - Dec. in DEGREES, same number of elements as X and Y

 RESTRICTIONS:
	Note that all angles are in degrees, including CD and CRVAL
	Also note that the CRPIX keyword assumes an FORTRAN type
	array beginning at (1,1), while X and Y give the IDL position
	beginning at (0,0).
	No parameter checking is performed.

 REVISION HISTORY:
	Written by R. Cornett, SASC Tech., 4/7/86
	Converted to IDL by B. Boothman, SASC Tech., 4/21/86
	Perform CD  multiplication in degrees  W. Landsman   Dec 1994
	Converted to IDL V5.0   W. Landsman   September 1997
       13-AUG-1997 R. Gastaud add distorsion flag
       15-AUG-1997 R. Gastaud distorsion ==> distortion
       06-AUG-1998 Seb Oliver default value for the distortion put in 
                   corrected bug where compute_distortion was called with x,x ---> x,y!
</PRE><P>
<STRONG>(See /contrib-linux/rsi/idl_5.4/icstm_idl/astrom/xy2ad.pro)</STRONG><P>
<HR>
 
</body>
</html>
