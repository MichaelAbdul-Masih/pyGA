<!-- This file was generated by icmk_html_help.pro -->
<html>
 
<head>
<TITLE>Extended IDL Help</TITLE>
</head>
 
<body>
<H1>Extended IDL Help</H1>
<P>
This page was created by the IDL library routine 
<CODE>icmk_html_help</CODE>.  For more information on 
this routine, refer to the IDL Online Help Navigator 
or type: <P>
<PRE>     ? mk_html_help</PRE><P>
at the IDL command line prompt.<P>
<STRONG>Last modified: </STRONG>Mon Mar 31 16:37:17 2003.<P>
 
<HR>
 
<A NAME="ROUTINELIST">
<H1>List of Routines</H1></A>
<UL>
<LI><A HREF="#AF_COUNTS">AF_COUNTS</A>
reads in Alberto Franceschini's tables of sources counts
<LI><A HREF="#CIRRUS_SED">CIRRUS_SED</A>Returns a cirrus FIR SED
<LI><A HREF="#CPP_COUNTS">CPP_COUNTS</A>
reads in Chris Pearsons tables of sources counts
<LI><A HREF="#GUIDER_COUNTS">GUIDER_COUNTS</A>
reas in Guiderdoni's tables of sources counts
<LI><A HREF="#ICAIRY">ICAIRY</A>
Produces the intensity of an ISO airy disk at a specified
<LI><A HREF="#ICBACKGROUND[1]">ICBACKGROUND[1]</A>
gives the background from the IC models at and given positions
<LI><A HREF="#ICBACKGROUND[2]">ICBACKGROUND[2]</A>
gives the background from the IC models at and given positions
<LI><A HREF="#ICMODEL_PSF">ICMODEL_PSF</A>models a psf of a given image size
<LI><A HREF="#IC_ZODIACAL_BACKGD">IC_ZODIACAL_BACKGD</A>
<LI><A HREF="#INT_TABULATED2">INT_TABULATED2</A>
This function integrates a tabulated set of data { x(i) , f(i) },
<LI><A HREF="#MODEL_SED">MODEL_SED</A>
takes input frequencies and fluxes for an object at
<LI><A HREF="#NEWCIRRUS_SED">NEWCIRRUS_SED</A>
Returns an SED that fits the spectrum of cirrus towards
<LI><A HREF="#NEWSTARBURST_SED[1]">NEWSTARBURST_SED[1]</A>
Returns a starburst SED
<LI><A HREF="#NEWSTARBURST_SED[2]">NEWSTARBURST_SED[2]</A>
Returns a starburst SED
<LI><A HREF="#NEWSTARBURST_SED[2]">NEWSTARBURST_SED[2]</A>
Returns a starburst SED
<LI><A HREF="#NOTUNIQ">NOTUNIQ</A>
Return the subscripts of the notunique elements in an array.
<LI><A HREF="#READBC95">READBC95</A>reads in a Bruzual and Charlot model file
<LI><A HREF="#SEARCH2D">SEARCH2D</A>
This function finds "objects" or regions of similar data
<LI><A HREF="#SEYFERT_SED">SEYFERT_SED</A>Returns a seyfert FIR SED
<LI><A HREF="#STARBURST_SED">STARBURST_SED</A>Returns a starburst FIR SED
<LI><A HREF="#WHEREIMAGE">WHEREIMAGE</A>
takes a list of array indicies and converts it into a
<LI><A HREF="#ZHMPNT[1]">ZHMPNT[1]</A>
reads the i100 intensity at a given ra,dec from Mark Jones's Map
<LI><A HREF="#ZHMPNT[2]">ZHMPNT[2]</A>
reads the i100 intensity at a given ra,dec from Mark Jones's Map
</UL><P>
 
<HR>
 
<H1>Routine Descriptions</H1>
<A NAME="AF_COUNTS">
<H2>AF_COUNTS</H2></A>
<A HREF="#CIRRUS_SED">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 NAME:
	af_counts

 PURPOSE:
	reads in Alberto Franceschini's tables of sources counts

 CATEGORY:
	Put a category (or categories) here.  For example: Widgets.

 CALLING SEQUENCE:
	af_counts,band,lgs,lgn,[type=type,/diff,/euclid,/order

 INPUTS:
	band:  band


 OPTIONAL INPUTS:
	
       lgs:  If lgs is not zeros then counts interpolated at these fluxes
             otherwise default table is returned
	
 KEYWORD PARAMETERS:
	type:  Galaxy Type
            = 'all'   :   total of below (Defualt)
            = 'spiral':     spiral galaxies 
            = 'elliptical':     elliptical galaxies (or E+s0 at 6,7)
            = 's0':     s0 galaxies (or E+s0 at 6,7)
            = 'starburst':     starburst galaxies (not at 6.7)
            = 'agn':      AGN
       diff: If set then differential counts are calculated rather than
             integral counts
       euclid: If set then euclidean differential counts are calculated rather than
             integral counts

 OUTPUTS:
	lgs:  log10(flux/Jy)
       lgn:   log10( N/sq deg > flux)  [if diff not set]
       lgn:   log10( -dN/ds / sr /Jy )  [if diff set]
       lgn:   log10( -S^2.5 dN/ds / sr /Jy )  [if euclid set]

 OPTIONAL OUTPUTS:
	

 COMMON BLOCKS:
	

 SIDE EFFECTS:
	

 RESTRICTIONS:
	Only reads in whole table could do differential counts
       or counts above given lgs limit

 PROCEDURE:
	

 EXAMPLE:
	

 MODIFICATION HISTORY:
 	Written by:	Seb Oliver 20th November 1996
	July, 1994	Any additional mods get described here.
</PRE><P>
<STRONG>(See /contrib-linux/rsi/idl_5.4/icstm_idl/general/af_counts.pro)</STRONG><P>
<HR>
 
<A NAME="CIRRUS_SED">
<H2>CIRRUS_SED</H2></A>
<A HREF="#AF_COUNTS">[Previous Routine]</A>
<A HREF="#CPP_COUNTS">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 NAME:
	cirrus_sed

 PURPOSE:
	Returns a cirrus FIR SED

 CATEGORY:
	analysis

 CALLING SEQUENCE:
	sed=cirrus_sed(lam)

 INPUTS:
	lam:  wavelength in Micron

 OPTIONAL INPUTS:
	
	
 KEYWORD PARAMETERS:
	

 OUTPUTS:
	cirrus_sed:  nuFnu of cirrus SED in arbitrary units

 OPTIONAL OUTPUTS:
	

 COMMON BLOCKS:
	

 SIDE EFFECTS:
	

 RESTRICTIONS:
	

 PROCEDURE:
	

 EXAMPLE:
	

 MODIFICATION HISTORY:
 	Written by:	Seb Oliver 20 th August 1996
	July, 1996	
</PRE><P>
<STRONG>(See /contrib-linux/rsi/idl_5.4/icstm_idl/general/cirrus_sed.pro)</STRONG><P>
<HR>
 
<A NAME="CPP_COUNTS">
<H2>CPP_COUNTS</H2></A>
<A HREF="#CIRRUS_SED">[Previous Routine]</A>
<A HREF="#GUIDER_COUNTS">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 NAME:
	cpp_counts

 PURPOSE:
	reads in Chris Pearsons tables of sources counts

 CATEGORY:
	Put a category (or categories) here.  For example: Widgets.

 CALLING SEQUENCE:
	cpp_counts,band,lgs,lgn,type=type,diff=diff

 INPUTS:
	band:  band


 OPTIONAL INPUTS:
	
       lgs:  If lgs is not zeros then counts interpolated at these fluxes
             otherwise default table is returned
	
 KEYWORD PARAMETERS:
	type:  Galaxy Type
            = 'all'   :   total of below (Defualt)
            = 'normal':     normal galaxies
            = 'starburst':     starburst galaxies
            = 'hyper':     hyper-luminous (F10214 like) galaxies
            = 'sey1':     Seyfert 1s
            = 'sey2':     Seyfert 2s
       diff: If set then differential counts are calculated rather than
             integral counts

 OUTPUTS:
	lgs:  log10(flux/Jy)
       lgn:   log10( N/sq deg > flux)  [if diff not set]
       lgn:   log10( -dN/ds / sq deg  /Jy )  [if diff set]
       

 OPTIONAL OUTPUTS:
	

 COMMON BLOCKS:
	

 SIDE EFFECTS:
	

 RESTRICTIONS:
	Only reads in whole table could do differential counts
       or counts above given lgs limit

 PROCEDURE:
	

 EXAMPLE:
	

 MODIFICATION HISTORY:
 	Written by:	Seb Oliver 5th August 1996
	July, 1994	Any additional mods get described here.
</PRE><P>
<STRONG>(See /contrib-linux/rsi/idl_5.4/icstm_idl/general/cpp_counts.pro)</STRONG><P>
<HR>
 
<A NAME="GUIDER_COUNTS">
<H2>GUIDER_COUNTS</H2></A>
<A HREF="#CPP_COUNTS">[Previous Routine]</A>
<A HREF="#ICAIRY">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 NAME:
	guider_counts

 PURPOSE:
	reas in Guiderdoni's tables of sources counts

 CATEGORY:
	Put a category (or categories) here.  For example: Widgets.

 CALLING SEQUENCE:
	guider_counts,band,lgs,lgn,type=type,diff=diff

 INPUTS:
	band:  band


 OPTIONAL INPUTS:
	
       lgs:  If lgs is not zeros then counts interpolated at these fluxes
             otherwise default table is returned
	
 KEYWORD PARAMETERS:
	type:  Galaxy Type
            = 'A'   :   model A
            = 'E':     model E
       diff: If set then differential counts are calculated rather than
             integral counts

 OUTPUTS:
	lgs:  log10(flux/Jy)
       lgn:   log10( N/sq deg > flux)  [if diff not set]
       lgn:   log10( -dN/ds / sq deg  /Jy )  [if diff set]
       

 OPTIONAL OUTPUTS:
	

 COMMON BLOCKS:
	

 SIDE EFFECTS:
	

 RESTRICTIONS:
	Only reads in whole table could do differential counts
       or counts above given lgs limit

 PROCEDURE:
	

 EXAMPLE:
	

 MODIFICATION HISTORY:
 	Written by:	Seb Oliver 19th January 1999 Updated from old version
	July, 1994	Any additional mods get described here.
</PRE><P>
<STRONG>(See /contrib-linux/rsi/idl_5.4/icstm_idl/general/guider_counts.pro)</STRONG><P>
<HR>
 
<A NAME="ICAIRY">
<H2>ICAIRY</H2></A>
<A HREF="#GUIDER_COUNTS">[Previous Routine]</A>
<A HREF="#ICBACKGROUND[1]">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 NAME:
	icairy

 PURPOSE:
	Produces the intensity of an ISO airy disk at a specified
       radius

 CATEGORY:
	analysis

 CALLING SEQUENCE:
	psf=icairy(theta,lambda)

 INPUTS:
	
       theta: angle from peak of source position in arc seconds
      lambda: wavelength in microns

 OPTIONAL INPUTS:
	
	
 KEYWORD PARAMETERS:
	diam:  diameter of telescope in microns

 OUTPUTS:
	

 OPTIONAL OUTPUTS:
	

 COMMON BLOCKS:
	

 SIDE EFFECTS:
	

 RESTRICTIONS:
	

 PROCEDURE:
	

 EXAMPLE:
	

 MODIFICATION HISTORY:
 	Written by:	Seb Oliver 19th September 1996
       19th January 1999 - diamter keyword added to allow other telescopes
	September, 1996	
</PRE><P>
<STRONG>(See /contrib-linux/rsi/idl_5.4/icstm_idl/general/icairy.pro)</STRONG><P>
<HR>
 
<A NAME="ICBACKGROUND[1]">
<H2>ICBACKGROUND[1]</H2></A>
<A HREF="#ICAIRY">[Previous Routine]</A>
<A HREF="#ICBACKGROUND[2]">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 NAME:
	icbackground

 PURPOSE:
	gives the background from the IC models at and given positions
       and dates.

 CATEGORY:
	analysis

 CALLING SEQUENCE:
	

 INPUTS:
	

 OPTIONAL INPUTS:
	
	
 KEYWORD PARAMETERS:
	

 OUTPUTS:
	

 OPTIONAL OUTPUTS:
	

 COMMON BLOCKS:
	

 SIDE EFFECTS:
	

 RESTRICTIONS:
	

 PROCEDURE:
	

 EXAMPLE:
	

 MODIFICATION HISTORY:
 	Written by:	Seb Oliver 13th Dec 1996
	July, 1996	
</PRE><P>
<STRONG>(See /contrib-linux/rsi/idl_5.4/icstm_idl/general/back.pro)</STRONG><P>
<HR>
 
<A NAME="ICBACKGROUND[2]">
<H2>ICBACKGROUND[2]</H2></A>
<A HREF="#ICBACKGROUND[1]">[Previous Routine]</A>
<A HREF="#ICMODEL_PSF">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 NAME:
	icbackground

 PURPOSE:
	gives the background from the IC models at and given positions
       and dates.

 CATEGORY:
	analysis

 CALLING SEQUENCE:
	

 INPUTS:
	

 OPTIONAL INPUTS:
	
	
 KEYWORD PARAMETERS:
	

 OUTPUTS:
	

 OPTIONAL OUTPUTS:
	

 COMMON BLOCKS:
	

 SIDE EFFECTS:
	

 RESTRICTIONS:
	

 PROCEDURE:
	

 EXAMPLE:
	

 MODIFICATION HISTORY:
 	Written by:	Seb Oliver 13th Dec 1996
       Bug that meant the cirrus background was screwy if a vector entered
       removed  Seb Oliver 23 June 1997
	July, 1996	
</PRE><P>
<STRONG>(See /contrib-linux/rsi/idl_5.4/icstm_idl/general/icbackground.pro)</STRONG><P>
<HR>
 
<A NAME="ICMODEL_PSF">
<H2>ICMODEL_PSF</H2></A>
<A HREF="#ICBACKGROUND[2]">[Previous Routine]</A>
<A HREF="#IC_ZODIACAL_BACKGD">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 NAME:
	icmodel_psf

 PURPOSE:
	models a psf of a given image size 
       image, pixel field of view, wavelength and
       source cen0

 CATEGORY:
	analysis

 CALLING SEQUENCE:
	icmodel_psf,psf,cen0,pfov,lambda

 INPUTS:
	psf: 2-D array for psf (Defualt 32,32)
       cen0: pixel coordinates of cen0 of source
       pfov: pixel field of view in arc sec
       lambda: wavelength in micron

 OPTIONAL INPUTS:
	
	
 KEYWORD PARAMETERS:
	diam: diameter of telescope

 OUTPUTS:
	

 OPTIONAL OUTPUTS:
	

 COMMON BLOCKS:
	

 SIDE EFFECTS:
	

 RESTRICTIONS:
	

 PROCEDURE:
	

 EXAMPLE:
	

 MODIFICATION HISTORY:
 	Written by:	Seb Oliver 26th September 1996
       19th January 1999 - diamter keyword added to allow other telescopes
	September, 1996	
</PRE><P>
<STRONG>(See /contrib-linux/rsi/idl_5.4/icstm_idl/general/icmodel_psf.pro)</STRONG><P>
<HR>
 
<A NAME="IC_ZODIACAL_BACKGD">
<H2>IC_ZODIACAL_BACKGD</H2></A>
<A HREF="#ICMODEL_PSF">[Previous Routine]</A>
<A HREF="#INT_TABULATED2">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 NAME:
       IC_ZODIACAL_BACKGD

 PURPOSE:

       Calculates zodiacal background in mid-ir for given 
       ecliptic latitude, solar elongation angle and wavelength. 
       The routine linearly interpolates between entries in table 8 
       of the ISOCAM Observer's Manual, but assumes a blackbody 
       zodiacal spectrum rather than the alternative in the manual. 

       Units are MJy/sr.  Divide by 42.5 to get mJy/sq arcsec


 CALLING SEQUENCE:
       backgd = ic_zodiacal_backdg(ecliptic_latitude, solar_elongation,$
                                   lambda)

 INPUTS:
       ecliptic_latitude: as is says
       solar_elongation : as is says
       lambda: wavelength 

 OPTIONAL INPUTS:
       none

 KEYWORD PARAMETERS:
       camman: uses the cam manual zodiacal spectrum instead of
               Hausman et al

 EXAMPLE:
       print, ic_zodiacal_backgd(10.0, 120.0, 10.9)

 MODIFICATION HISTORY:
 
 original version MRR
 changed 16/7/94 from program to subroutine, and zodi.dat included
                 as data statment rather than read in from file
                 by Seb Oliver
 Translated from FORTRAN subroutine to IDL function, and modified to
 accept solar elongation as an input parameter. Zodi.dat data also 
 incorporated within code. S Serjeant 9 Aug 1996
 uses absolute eclliptica latitude Seb 13 th Dec 1996
 camman keyword added S Serjeant 30 May 1997

</PRE><P>
<STRONG>(See /contrib-linux/rsi/idl_5.4/icstm_idl/general/ic_zodiacal_backgd.pro)</STRONG><P>
<HR>
 
<A NAME="INT_TABULATED2">
<H2>INT_TABULATED2</H2></A>
<A HREF="#IC_ZODIACAL_BACKGD">[Previous Routine]</A>
<A HREF="#MODEL_SED">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 NAME:
       INT_TABULATED2

 PURPOSE:
       This function integrates a tabulated set of data { x(i) , f(i) },
       on the closed interval [min(X) , max(X)].

 CATEGORY:
       Numerical Analysis.

 CALLING SEQUENCE:
       Result = INT_TABULATED(X, F)

 INPUTS:
       X:  The tabulated X-value data. This data may be irregularly
           gridded and in random order.
       F:  The tabulated F-value data. Upon input to the function
           X(i) and F(i) must have corresponding indices for all
	    values of i. If X is reordered, F is also reordered.

       X and F must be of floating point or double precision type.

 KEYWORD PARAMETERS:

 OUTPUTS:
       This fuction returns the integral of F computed from the tabulated
	data in the closed interval [min(X) , max(X)].

 RESTRICTIONS:

 PROCEDURE:
       INT_TABULATED2 
       has a similar functionality to the intrinsci function
       int_tabulated but uses the trapizium rule and is more robust
       to rapidly varying functions


 EXAMPLES:
       Example 1:

 MODIFICATION HISTORY:
           Written by:  Seb Oliver c. 1997
           Modified:   any modifications here
</PRE><P>
<STRONG>(See /contrib-linux/rsi/idl_5.4/icstm_idl/general/int_tabulated2.pro)</STRONG><P>
<HR>
 
<A NAME="MODEL_SED">
<H2>MODEL_SED</H2></A>
<A HREF="#INT_TABULATED2">[Previous Routine]</A>
<A HREF="#NEWCIRRUS_SED">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 NAME:
	model_sed

 PURPOSE:
	takes input frequencies and fluxes for an object at
       a given redshift and returns a model sed 


 CATEGORY:
	analysis

 CALLING SEQUENCE:
	

 INPUTS:
	
         nu_in :  vector of observed frequencies Log10(Hz)
         nufnu_in: vector of observed fluxes Log10(Wm-2Hz-1)
         bandhz:  bandwidth  in hz
         z :       object redshift
         unit: unit to which to write results

 OPTIONAL INPUTS:
	
	
 KEYWORD PARAMETERS:
	
	sedmodel: model sed to be used: starburst, starburst2, cirrus or 
		  Seyfert - default is starburst


 OUTPUTS:
	nu_out:  model_sed frequencies Log10(Hz)
       nufnu_out: fir model sed fluxes  Log10(Wm-2Hz-1)
       nufnu0: model nuFnu values at 0.3, 0.8, 15 and 60 microns

 OPTIONAL OUTPUTS:
	

 COMMON BLOCKS:
	

 SIDE EFFECTS:
	

 RESTRICTIONS:
	

 PROCEDURE:
	

 EXAMPLE:
	

 MODIFICATION HISTORY:
 	Written by:	Seb Oliver 30th October 1996
	7  November 1996: modified to include new cirrus SED as well
	11 November 1996: modified to run over full set of BC95 models	
	17 February 1997: modified to add model keyword
	7 March 1997: modified to add starburst2 SED
</PRE><P>
<STRONG>(See /contrib-linux/rsi/idl_5.4/icstm_idl/general/model_sed.pro)</STRONG><P>
<HR>
 
<A NAME="NEWCIRRUS_SED">
<H2>NEWCIRRUS_SED</H2></A>
<A HREF="#MODEL_SED">[Previous Routine]</A>
<A HREF="#NEWSTARBURST_SED[1]">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 NAME:
	newcirrus_sed

 PURPOSE:
	Returns an SED that fits the spectrum of cirrus towards
       the center of the galaxy.

 CATEGORY:
	analysis

 CALLING SEQUENCE:
	sed=newcirrus_sed(lam)

 INPUTS:

 OPTIONAL INPUTS:
	lam:  wavelength in Micron
	
	
 KEYWORD PARAMETERS:
	

 OUTPUTS:
	newcirrus_sed:  nuFnu of cirrus SED. Normalised so that the
                       bolometric luminosity of the model integrates to 1

 OPTIONAL OUTPUTS:
	

 COMMON BLOCKS:
	

 SIDE EFFECTS:
	

 RESTRICTIONS:
	

 PROCEDURE:
	

 EXAMPLE:
	

 MODIFICATION HISTORY:
 	Written by:	Seb Oliver 20 th August 1996
	November, 1996	Andreas Efstathiou
                       Updated to  read cirrus spectrum from a file
</PRE><P>
<STRONG>(See /contrib-linux/rsi/idl_5.4/icstm_idl/general/newcirrus_sed.pro)</STRONG><P>
<HR>
 
<A NAME="NEWSTARBURST_SED[1]">
<H2>NEWSTARBURST_SED[1]</H2></A>
<A HREF="#NEWCIRRUS_SED">[Previous Routine]</A>
<A HREF="#NEWSTARBURST_SED[2]">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 NAME:
	newstarburst_sed

 PURPOSE:
	Returns a starburst SED 

 CATEGORY:
	analysis

 CALLING SEQUENCE:
	sed=newstarburst_sed(lam)

 INPUTS:

 OPTIONAL INPUTS:
	lam:  wavelength in Micron
	
	
 KEYWORD PARAMETERS:
	lam0: if set and lam is not then walues from data file are returned
        m82: if set then m82 spectrum is used

 OUTPUTS:
	newstarburst_sed:  nuFnu of starburst SED. Normalised so that the
                       bolometric luminosity of the model is equal to 1

 OPTIONAL OUTPUTS:
	

 COMMON BLOCKS:
	

 SIDE EFFECTS:
	

 RESTRICTIONS:
	

 PROCEDURE:
	

 EXAMPLE:
	

 MODIFICATION HISTORY:
 	Written by:	Seb Oliver 20 th August 1996
	November, 1996	Andreas Efstathiou
                       Updated to  read starburst spectrum from a file
                       Starburst model now includes PAHs
       Decmeber 2, 1997 Seb Oliver New M82 model added and 
                        does not require input lambda to be specfied
</PRE><P>
<STRONG>(See /contrib-linux/rsi/idl_5.4/icstm_idl/general/newstarburst_sed.pro)</STRONG><P>
<HR>
 
<A NAME="NEWSTARBURST_SED[2]">
<H2>NEWSTARBURST_SED[2]</H2></A>
<A HREF="#NEWSTARBURST_SED[1]">[Previous Routine]</A>
<A HREF="#NEWSTARBURST_SED[2]">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 NAME:
	newstarburst_sed

 PURPOSE:
	Returns a starburst SED 

 CATEGORY:
	analysis

 CALLING SEQUENCE:
	sed=newstarburst_sed(lam)

 INPUTS:

 OPTIONAL INPUTS:
	lam:  wavelength in Micron
	
	
 KEYWORD PARAMETERS:
	lam0: if set and lam is not then walues from data file are returned
        m82: if set then m82 spectrum is used

 OUTPUTS:
	newstarburst_sed:  nuFnu of starburst SED. Normalised so that the
                       bolometric luminosity of the model is equal to 1

 OPTIONAL OUTPUTS:
	

 COMMON BLOCKS:
	

 SIDE EFFECTS:
	

 RESTRICTIONS:
	

 PROCEDURE:
	

 EXAMPLE:
	

 MODIFICATION HISTORY:
 	Written by:	Seb Oliver 20 th August 1996
	November, 1996	Andreas Efstathiou
                       Updated to  read starburst spectrum from a file
                       Starburst model now includes PAHs
       Decmeber 2, 1997 Seb Oliver New M82 model added and 
                        does not require input lambda to be specfied
</PRE><P>
<STRONG>(See /contrib-linux/rsi/idl_5.4/icstm_idl/general/newstarburst_sed3.pro)</STRONG><P>
<HR>
 
<A NAME="NEWSTARBURST_SED[2]">
<H2>NEWSTARBURST_SED[2]</H2></A>
<A HREF="#NEWSTARBURST_SED[2]">[Previous Routine]</A>
<A HREF="#NOTUNIQ">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 NAME:
	newstarburst_sed

 PURPOSE:
	Returns a starburst SED 

 CATEGORY:
	analysis

 CALLING SEQUENCE:
	sed=newstarburst_sed_band(lam,band,/radio)

 INPUTS:

 OPTIONAL INPUTS:
	lam:  wavelength in Micron
	band: bandwidth in Micron if zero then nuFnu is returned
	
 KEYWORD PARAMETERS:
	

 OUTPUTS:
	newstarburst_sed_band:  
                       Integral of Fnu dnu over band
                       of starburst SED. Normalised so that the
                       bolometric luminosity of the model is equal to 1
                       If a bandwidth of zero is set then nuFnu is returned
                       

 OPTIONAL OUTPUTS:
	

 COMMON BLOCKS:
	

 SIDE EFFECTS:
	

 RESTRICTIONS:
	

 PROCEDURE:
	

 EXAMPLE:
	

 MODIFICATION HISTORY:
 	Written by:	Seb Oliver 20 th August 1996
	November, 1996	Andreas Efstathiou
                       Updated to  read starburst spectrum from a file
                      Starburst model now includes PAHs
       November, 1996  Bandpass added and radio option added
</PRE><P>
<STRONG>(See /contrib-linux/rsi/idl_5.4/icstm_idl/general/newstarburst_sed_band.pro)</STRONG><P>
<HR>
 
<A NAME="NOTUNIQ">
<H2>NOTUNIQ</H2></A>
<A HREF="#NEWSTARBURST_SED[2]">[Previous Routine]</A>
<A HREF="#READBC95">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 NAME:
	NOTUNIQ

 PURPOSE:
	Return the subscripts of the notunique elements in an array.

	Note that repeated elements must be adjacent in order to be
	found.  This routine is intended to be used with the SORT
	function.  See the discussion of the IDX argument below.

	This command is inspired by the Unix uniq(1) command.

 CATEGORY:
	Array manipulation.

 CALLING SEQUENCE:
	NOTUNIQ(Array [, Idx])

 INPUTS:
	Array:	The array to be scanned.  The type and number of dimensions
		of the array are not important.  The array must be sorted
		into monotonic order unless the optional parameter Idx is 
		supplied.

 OPTIONAL INPUT PARAMETERS:
	IDX:	This optional parameter is an array of indices into Array
		that order the elements into monotonic order.
		That is, the expression:

			Array(Idx)

		yields an array in which the elements of Array are
		rearranged into monotonic order.  If the array is not
		already in monotonic order, use the command:

			NOTUNIQ(Array, SORT(Array))

		The expression below finds the notunique elements of an unsorted
		array:

			Array(NOTUNIQ(Array, SORT(Array)))

 OUTPUTS:
	An array of indicies into ARRAY is returned.  The expression:

		ARRAY(NOTUNIQ(ARRAY))

	will be a copy of the sorted Array with duplicate adjacent
	elements removed.

 COMMON BLOCKS:
	None.

 MODIFICATION HISTORY:
	1988, AB, Written.
	29 July 1992, ACY - Corrected for case of all elements the same.
	Nov, 1995.  DMS, Return a 0 if argument is a scalar.
       Jul 27 1999, created as exact opposite to intrinsic IDL UNIQ
       function, Seb Oliver

</PRE><P>
<STRONG>(See /contrib-linux/rsi/idl_5.4/icstm_idl/general/notuniq.pro)</STRONG><P>
<HR>
 
<A NAME="READBC95">
<H2>READBC95</H2></A>
<A HREF="#NOTUNIQ">[Previous Routine]</A>
<A HREF="#SEARCH2D">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 NAME:
	readbc95

 PURPOSE:
	reads in a Bruzual and Charlot model file

 CATEGORY:
	analysis

 CALLING SEQUENCE:
	readbc95,file,ks,iw,t,w,f

 INPUTS:
	file: file name

 OPTIONAL INPUTS:
	ks: number of models
       iw: number of wavelength bins
        t: time after start of model
        w: wavelength in A
        f: spectra 
	
 KEYWORD PARAMETERS:
	

 OUTPUTS:
	bc95_sed:  

 OPTIONAL OUTPUTS:
	

 COMMON BLOCKS:
	

 SIDE EFFECTS:
	

 RESTRICTIONS:
	

 PROCEDURE:
	

 EXAMPLE:
	

 MODIFICATION HISTORY:
 	Written by:	Seb Oliver 20 th August 1996
	July, 1996	
</PRE><P>
<STRONG>(See /contrib-linux/rsi/idl_5.4/icstm_idl/general/readbc95.pro)</STRONG><P>
<HR>
 
<A NAME="SEARCH2D">
<H2>SEARCH2D</H2></A>
<A HREF="#READBC95">[Previous Routine]</A>
<A HREF="#SEYFERT_SED">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 NAME:
	SEARCH2D

 PURPOSE:
	This function finds "objects" or regions of similar data
       values within a 2-D array of data. Given a starting location
       and a range of values to search for, SEARCH2D will find all
       the cells within the array that are within the specified range
       of values, and have some path of connectivity through these cells
       to the starting location. In addition to searching for cells
       within a global range of data values, SEARCH2D can also search
       for adjacent cells whose values deviate from their neighbors within
       specified tolerances. See the procedure "SEARCH3D" for the
       three dimensional case.

       This function returns a list of the array subscripts that define
       the selected object or region.

 CATEGORY:
       Data subsetting.
	Image manipulation.

 CALLING SEQUENCE:
       Region = SEARCH2D(Array, Xpos, Ypos, Min_val, Max_val)

 INPUTS:
       Array:      The 2-D array of data to search.
                   Data type : Any 2-D array except string or structure.
       Xpos:       The X coordinate (first subscript into the 2-D Array)
                   of the starting cell for the search.
                   Data type : Long.
       Ypos:       The Y coordinate (second subscript into the 2-D Array)
                   of the starting cell for the search.
                   Data type : Long.
       Min_val:    The minimum data value to search for. All cells that
                   are connected to the starting cell, and have a value
                   greater than or equal to Min_val and less that or equal
                   to Max_val, will be considered part of the "object".
       Max_val:    The maximum data value to search for.

 KEYWORD PARAMETERS:
       DECREASE:   If the DECREASE or INCREASE keywords are specified,
                   then SEARCH2D creates an internal copy of Array.
                   This internal copy is then processed to enhance the
                   object edges by using an algorithm similar to the
                   "SOBEL" edge enhancement process. Any adjacent
                   cells will be found if their corresponding data value
                   in the edge enhanced array is greater than DECREASE and
                   less than INCREASE. In any case, the adjacent cells
                   will NEVER be selected if their data value is not
                   between Min_val and Max_val.
                   The default is 0.0 if INCREASE is specified.
                   Otherwise, the default is no edge checking.
                   Data type : Int or Float (usually less than zero).
       INCREASE:   The maximum value in the edge enhanced array for
                   a cell to be considered part of the selected object.
                   Some savings in execution time and memory usage result
                   when DECREASE and INCREASE are omitted.
                   See DECREASE above.
                   The default is 0.0 if DECREASE is specified.
                   Otherwise, the default is no edge checking.
                   Data type : Int or Float (usually greater than zero).
       LPF_BAND:   This keyword indicates what (if any) Low Pass Filtering
                   is performed on the edge enhanced array before the
                   search begins. If LPF_BAND is set to 3 or higher
                   then the edge enhanced array will be smoothed using
                   LPF_BAND as the width of the smoothing window.
                   If LPF_BAND is less than 3 then no smoothing is
                   performed. This keyword only has effect when the
                   DECREASE or INCREASE keywords are supplied.
                   See DECREASE above.
                   The default is zero (no smoothing).
                   Data type : Int.
       DIAGONAL:   Normally, cells are considered adjacent only when
                   squares surrounding the cells share a common edge.
                   If a non-zero value is passed to DIAGONAL then
                   SEARCH2D will also locate cells meeting the search
                   criteria whose surrounding squares share a common
                   corner. Specifying diagonal search mode requires
                   more memory and execution time.
                   The default is no diagonal searching.
                   Data type : int

 OUTPUTS:
       This function returns a list of the indices into the 2-D array
       that are part of the located object or region. This list is
       returned as a LONARR(n) where n is the number of cells found.

       If the returned array of indices is called Region, and the
       size of the 2-D array of data is size_x by size_y, then the
       actual X and Y indices can be obtained by using the following
       algorithm :

          index_y = Region / size_x
          index_x = Region - (index_y * size_x)

       The object within the 2-D Array could then be subscripted as :

          Array(Region)
       OR
          Array(index_x, index_y)

 EXAMPLE:
       Find all the indices corresponding to an object contained in a
       2-D array of data.

       ; Create some data.
          img = FLTARR(512, 512)
          img(3:503, 9:488) = 0.7
          img(37:455, 18:438) = 0.5
          img(144:388, 90:400) = 0.7
          img(200:301, 1:255) = 1.0
          img(155:193, 333:387) = 0.3

       ; Display the image.
          TVSCL, img

       ; Search for an object starting at (175, 300) whose data values
       ; are between (0.6) and (0.8).
          Region = SEARCH2D(img, 175, 300, 0.6, 0.8, /DIAGONAL)
 
       ; Scale the background cells into the range 0 to 127.
          img = BYTSCL(img, TOP=127B)

       ; Highlight the object region by setting it to 255.
          img(Region) = 255B
 
       ; Display the array with the highlighted object in it.
          TVSCL, img

 MODIFICATION HISTORY:
       Written by:     Daniel Carr. Thu Sep  3 15:36:17 MDT 1992
</PRE><P>
<STRONG>(See /contrib-linux/rsi/idl_5.4/icstm_idl/general/search2d.pro)</STRONG><P>
<HR>
 
<A NAME="SEYFERT_SED">
<H2>SEYFERT_SED</H2></A>
<A HREF="#SEARCH2D">[Previous Routine]</A>
<A HREF="#STARBURST_SED">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 NAME:
	seyfert_sed

 PURPOSE:
	Returns a seyfert FIR SED

 CATEGORY:
	analysis

 CALLING SEQUENCE:
	sed=seyfert_sed(lam)

 INPUTS:
	lam:  wavelength in Micron

 OPTIONAL INPUTS:
	
	
 KEYWORD PARAMETERS:
	

 OUTPUTS:
	seyfert_sed:   nuFnu of seyfert SED in arbitrary units

 OPTIONAL OUTPUTS:
	

 COMMON BLOCKS:
	

 SIDE EFFECTS:
	

 RESTRICTIONS:
	

 PROCEDURE:
	

 EXAMPLE:
	

 MODIFICATION HISTORY:
 	Written by:	Seb Oliver 20 th August 1996
	July, 1996	
</PRE><P>
<STRONG>(See /contrib-linux/rsi/idl_5.4/icstm_idl/general/seyfert_sed.pro)</STRONG><P>
<HR>
 
<A NAME="STARBURST_SED">
<H2>STARBURST_SED</H2></A>
<A HREF="#SEYFERT_SED">[Previous Routine]</A>
<A HREF="#WHEREIMAGE">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 NAME:
	starburst_sed

 PURPOSE:
	Returns a starburst FIR SED

 CATEGORY:
	analysis

 CALLING SEQUENCE:
	sed=starburst_sed(lam)

 INPUTS:
	lam:  wavelength in Micron

 OPTIONAL INPUTS:
	
	
 KEYWORD PARAMETERS:
	

 OUTPUTS:
	starburst_sed:  nuFnu of starburst SED  normalised so Bolometric
                                luminosity=1
             


 OPTIONAL OUTPUTS:
	

 COMMON BLOCKS:
	

 SIDE EFFECTS:
	

 RESTRICTIONS:
	

 PROCEDURE:
	

 EXAMPLE:
	

 MODIFICATION HISTORY:
 	Written by:	Seb Oliver 20 th August 1996
	July, 1996	
</PRE><P>
<STRONG>(See /contrib-linux/rsi/idl_5.4/icstm_idl/general/starburst_sed.pro)</STRONG><P>
<HR>
 
<A NAME="WHEREIMAGE">
<H2>WHEREIMAGE</H2></A>
<A HREF="#STARBURST_SED">[Previous Routine]</A>
<A HREF="#ZHMPNT[1]">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 NAME:
	whereimage

 PURPOSE:
	takes a list of array indicies and converts it into a
       list of multi-D subscripts indicies for >=2-D arrays

 CATEGORY:
	analysis

 CALLING SEQUENCE: whereimage,imsize,list,isub,jsub
	

 INPUTS:
	imsize: ouput of SIZE function applied to image
       list:   list of 1-D subscripts
     

 OPTIONAL INPUTS:
	
	
 KEYWORD PARAMETERS:
	

 OUTPUTS:
	isub:  i subscript
       jsub:  j subscript

 OPTIONAL OUTPUTS:
	

 COMMON BLOCKS:
	

 SIDE EFFECTS:
	

 RESTRICTIONS:
	
       only works on 2-D arrays so far

 PROCEDURE:
	

 EXAMPLE:
       IDL> modelpsf = findgen(100,100)/1000.
	IDL> br=where(modelpsf gt 0.001)
	IDL> sz=size(modelpsf)
	IDL> whereimage,sz,br,i,j
	IDL> print,i,j


 MODIFICATION HISTORY:
 	Written by:	Seb Oliver 26th July 1996
	July, 1996	
</PRE><P>
<STRONG>(See /contrib-linux/rsi/idl_5.4/icstm_idl/general/whereimage.pro)</STRONG><P>
<HR>
 
<A NAME="ZHMPNT[1]">
<H2>ZHMPNT[1]</H2></A>
<A HREF="#WHEREIMAGE">[Previous Routine]</A>
<A HREF="#ZHMPNT[2]">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 NAME:
	zhmpnt

 PURPOSE:
	reads the i100 intensity at a given ra,dec from Mark Jones's Map

 CATEGORY:
	Put a category (or categories) here.  For example: Widgets.

 CALLING SEQUENCE:
	 ZHMPNT,ra,dec,i100_out,/j2000

 INPUTS:
	ra: decimal degrees (1950?) can be scalers, vector or matrix
       dec: decimal degrees (1950?)

 OPTIONAL INPUTS:
	
	
 KEYWORD PARAMETERS:
	
      j2000: If set then input coordinates are in j2000  
             if not set then input coordinates are in B1950

 OUTPUTS:
	i100_out:  Intensity at 100 micron in MJy/sr

 OPTIONAL OUTPUTS:
	Describe optional outputs here.

 COMMON BLOCKS:
	BLOCK1:	Describe any common blocks here.

 SIDE EFFECTS:
	Describe "side effects" here.

 RESTRICTIONS:
	Describe any "restrictions" here.

 PROCEDURE:
	You can describe the foobar superfloatation method being used here.

 EXAMPLE:
	Making a plot of i100 in Galactic Coordinates

 IDL> gallon=findgen(360)*0.5-90.
 IDL> gallon=replicate(1,360)#gallon
 IDL> gallat=findgen(360)
 IDL> gallat=gallat#replicate(1,360)
 IDL> euler,gallon,gallat,ra,dec,2
 IDL> zhmpnt,ra,dec,i100_out
 IDL> implot,i100_out


 MODIFICATION HISTORY:
 	Written by:	Seb Oliver August 1996 Adapted from MHJ's fortan
	July, 1994	Any additional mods get described here.
</PRE><P>
<STRONG>(See /contrib-linux/rsi/idl_5.4/icstm_idl/general/zhmpnt.pro)</STRONG><P>
<HR>
 
<A NAME="ZHMPNT[2]">
<H2>ZHMPNT[2]</H2></A>
<A HREF="#ZHMPNT[1]">[Previous Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 NAME:
	zhmpnt

 PURPOSE:
	reads the i100 intensity at a given ra,dec from Mark Jones's Map

 CATEGORY:
	Put a category (or categories) here.  For example: Widgets.

 CALLING SEQUENCE:
	 ZHMPNT,ra,dec,i100_out,/j2000

 INPUTS:
	ra: decimal degrees (1950?) can be scalers, vector or matrix
       dec: decimal degrees (1950?)

 OPTIONAL INPUTS:
	
	
 KEYWORD PARAMETERS:
	
      j2000: If set then input coordinates are in j2000  
             if not set then input coordinates are in B1950

 OUTPUTS:
	i100_out:  Intensity at 100 micron in MJy/sr

 OPTIONAL OUTPUTS:
	Describe optional outputs here.

 COMMON BLOCKS:
	BLOCK1:	Describe any common blocks here.

 SIDE EFFECTS:
	Describe "side effects" here.

 RESTRICTIONS:
	Describe any "restrictions" here.

 PROCEDURE:
	You can describe the foobar superfloatation method being used here.

 EXAMPLE:
	Making a plot of i100 in Galactic Coordinates

 IDL> gallon=findgen(360)*0.5-90.
 IDL> gallon=replicate(1,360)#gallon
 IDL> gallat=findgen(360)
 IDL> gallat=gallat#replicate(1,360)
 IDL> euler,gallon,gallat,ra,dec,2
 IDL> zhmpnt,ra,dec,i100_out
 IDL> implot,i100_out


 MODIFICATION HISTORY:
 	Written by:	Seb Oliver August 1996 Adapted from MHJ's fortan
	July, 1994	Any additional mods get described here.
</PRE><P>
<STRONG>(See /contrib-linux/rsi/idl_5.4/icstm_idl/general/zhmpnt_2.pro)</STRONG><P>
<HR>
 
</body>
</html>
